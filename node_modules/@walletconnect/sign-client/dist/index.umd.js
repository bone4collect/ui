(function(xe,et){typeof exports=="object"&&typeof module<"u"?et(exports):typeof define=="function"&&define.amd?define(["exports"],et):(xe=typeof globalThis<"u"?globalThis:xe||self,et(xe["@walletconnect/sign-client"]={}))})(this,function(xe){"use strict";var et=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Kt(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}function Qa(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var ec=tc;function tc(t,e,r){var n=r&&r.stringify||Qa,i=1;if(typeof t=="object"&&t!==null){var s=e.length+i;if(s===1)return t;var a=new Array(s);a[0]=n(t);for(var c=1;c<s;c++)a[c]=n(e[c]);return a.join(" ")}if(typeof t!="string")return t;var h=e.length;if(h===0)return t;for(var f="",l=1-i,m=-1,b=t&&t.length||0,y=0;y<b;){if(t.charCodeAt(y)===37&&y+1<b){switch(m=m>-1?m:0,t.charCodeAt(y+1)){case 100:case 102:if(l>=h||e[l]==null)break;m<y&&(f+=t.slice(m,y)),f+=Number(e[l]),m=y+2,y++;break;case 105:if(l>=h||e[l]==null)break;m<y&&(f+=t.slice(m,y)),f+=Math.floor(Number(e[l])),m=y+2,y++;break;case 79:case 111:case 106:if(l>=h||e[l]===void 0)break;m<y&&(f+=t.slice(m,y));var S=typeof e[l];if(S==="string"){f+="'"+e[l]+"'",m=y+2,y++;break}if(S==="function"){f+=e[l].name||"<anonymous>",m=y+2,y++;break}f+=n(e[l]),m=y+2,y++;break;case 115:if(l>=h)break;m<y&&(f+=t.slice(m,y)),f+=String(e[l]),m=y+2,y++;break;case 37:m<y&&(f+=t.slice(m,y)),f+="%",m=y+2,y++,l--;break}++l}++y}return m===-1?t:(m<b&&(f+=t.slice(m)),f)}const Bi=ec;var qr=Dt;const hr=hc().console||{},rc={mapHttpRequest:Hr,mapHttpResponse:Hr,wrapRequestSerializer:xn,wrapResponseSerializer:xn,wrapErrorSerializer:xn,req:Hr,res:Hr,err:ac};function nc(t,e){return Array.isArray(t)?t.filter(function(n){return n!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Dt(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||hr;t.browser.write&&(t.browser.asObject=!0);const n=t.serializers||{},i=nc(t.browser.serialize,n);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const a=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const c=t.level||"info",h=Object.create(r);h.log||(h.log=lr),Object.defineProperty(h,"levelVal",{get:l}),Object.defineProperty(h,"level",{get:m,set:b});const f={transmit:e,serialize:i,asObject:t.browser.asObject,levels:a,timestamp:cc(t)};h.levels=Dt.levels,h.level=c,h.setMaxListeners=h.getMaxListeners=h.emit=h.addListener=h.on=h.prependListener=h.once=h.prependOnceListener=h.removeListener=h.removeAllListeners=h.listeners=h.listenerCount=h.eventNames=h.write=h.flush=lr,h.serializers=n,h._serialize=i,h._stdErrSerialize=s,h.child=y,e&&(h._logEvent=On());function l(){return this.level==="silent"?1/0:this.levels.values[this.level]}function m(){return this._level}function b(S){if(S!=="silent"&&!this.levels.values[S])throw Error("unknown level "+S);this._level=S,rr(f,h,"error","log"),rr(f,h,"fatal","error"),rr(f,h,"warn","error"),rr(f,h,"info","log"),rr(f,h,"debug","log"),rr(f,h,"trace","log")}function y(S,P){if(!S)throw new Error("missing bindings for child Pino");P=P||{},i&&S.serializers&&(P.serializers=S.serializers);const R=P.serializers;if(i&&R){var j=Object.assign({},n,R),E=t.browser.serialize===!0?Object.keys(j):i;delete S.serializers,Kr([S],E,j,this._stdErrSerialize)}function x(g){this._childLevel=(g._childLevel|0)+1,this.error=nr(g,S,"error"),this.fatal=nr(g,S,"fatal"),this.warn=nr(g,S,"warn"),this.info=nr(g,S,"info"),this.debug=nr(g,S,"debug"),this.trace=nr(g,S,"trace"),j&&(this.serializers=j,this._serialize=E),e&&(this._logEvent=On([].concat(g._logEvent.bindings,S)))}return x.prototype=this,new x(this)}return h}Dt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Dt.stdSerializers=rc,Dt.stdTimeFunctions=Object.assign({},{nullTime:qi,epochTime:Ki,unixTime:uc,isoTime:fc});function rr(t,e,r,n){const i=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?lr:i[r]?i[r]:hr[r]||hr[n]||lr,ic(t,e,r)}function ic(t,e,r){!t.transmit&&e[r]===lr||(e[r]=function(n){return function(){const s=t.timestamp(),a=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===hr?hr:this;for(var h=0;h<a.length;h++)a[h]=arguments[h];if(t.serialize&&!t.asObject&&Kr(a,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?n.call(c,sc(this,r,a,s)):n.apply(c,a),t.transmit){const f=t.transmit.level||e.level,l=Dt.levels.values[f],m=Dt.levels.values[r];if(m<l)return;oc(this,{ts:s,methodLevel:r,methodValue:m,transmitLevel:f,transmitValue:Dt.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},a)}}}(e[r]))}function sc(t,e,r,n){t._serialize&&Kr(r,t._serialize,t.serializers,t._stdErrSerialize);const i=r.slice();let s=i[0];const a={};n&&(a.time=n),a.level=Dt.levels.values[e];let c=(t._childLevel|0)+1;if(c<1&&(c=1),s!==null&&typeof s=="object"){for(;c--&&typeof i[0]=="object";)Object.assign(a,i.shift());s=i.length?Bi(i.shift(),i):void 0}else typeof s=="string"&&(s=Bi(i.shift(),i));return s!==void 0&&(a.msg=s),a}function Kr(t,e,r,n){for(const i in t)if(n&&t[i]instanceof Error)t[i]=Dt.stdSerializers.err(t[i]);else if(typeof t[i]=="object"&&!Array.isArray(t[i]))for(const s in t[i])e&&e.indexOf(s)>-1&&s in r&&(t[i][s]=r[s](t[i][s]))}function nr(t,e,r){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return t[r].apply(this,n)}}function oc(t,e,r){const n=e.send,i=e.ts,s=e.methodLevel,a=e.methodValue,c=e.val,h=t._logEvent.bindings;Kr(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=r.filter(function(f){return h.indexOf(f)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=a,n(s,t._logEvent,c),t._logEvent=On(h)}function On(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function ac(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function cc(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?qi:Ki}function Hr(){return{}}function xn(t){return t}function lr(){}function qi(){return!1}function Ki(){return Date.now()}function uc(){return Math.round(Date.now()/1e3)}function fc(){return new Date(Date.now()).toISOString()}function hc(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var ut={exports:{}},ir=typeof Reflect=="object"?Reflect:null,Hi=ir&&typeof ir.apply=="function"?ir.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Vr;ir&&typeof ir.ownKeys=="function"?Vr=ir.ownKeys:Object.getOwnPropertySymbols?Vr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Vr=function(e){return Object.getOwnPropertyNames(e)};function lc(t){console&&console.warn&&console.warn(t)}var Vi=Number.isNaN||function(e){return e!==e};function De(){De.init.call(this)}ut.exports=De,ut.exports.once=_c,De.EventEmitter=De,De.prototype._events=void 0,De.prototype._eventsCount=0,De.prototype._maxListeners=void 0;var Gi=10;function Gr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(De,"defaultMaxListeners",{enumerable:!0,get:function(){return Gi},set:function(t){if(typeof t!="number"||t<0||Vi(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Gi=t}}),De.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},De.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Vi(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Wi(t){return t._maxListeners===void 0?De.defaultMaxListeners:t._maxListeners}De.prototype.getMaxListeners=function(){return Wi(this)},De.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(r.length>0&&(a=r[0]),a instanceof Error)throw a;var c=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw c.context=a,c}var h=s[e];if(h===void 0)return!1;if(typeof h=="function")Hi(h,this,r);else for(var f=h.length,l=Zi(h,f),n=0;n<f;++n)Hi(l[n],this,r);return!0};function Yi(t,e,r,n){var i,s,a;if(Gr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),a=s[e]),a===void 0)a=s[e]=r,++t._eventsCount;else if(typeof a=="function"?a=s[e]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),i=Wi(t),i>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=a.length,lc(c)}return t}De.prototype.addListener=function(e,r){return Yi(this,e,r,!1)},De.prototype.on=De.prototype.addListener,De.prototype.prependListener=function(e,r){return Yi(this,e,r,!0)};function dc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ki(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=dc.bind(n);return i.listener=r,n.wrapFn=i,i}De.prototype.once=function(e,r){return Gr(r),this.on(e,ki(this,e,r)),this},De.prototype.prependOnceListener=function(e,r){return Gr(r),this.prependListener(e,ki(this,e,r)),this},De.prototype.removeListener=function(e,r){var n,i,s,a,c;if(Gr(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,a=n.length-1;a>=0;a--)if(n[a]===r||n[a].listener===r){c=n[a].listener,s=a;break}if(s<0)return this;s===0?n.shift():pc(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,c||r)}return this},De.prototype.off=De.prototype.removeListener,De.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function Xi(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?gc(i):Zi(i,i.length)}De.prototype.listeners=function(e){return Xi(this,e,!0)},De.prototype.rawListeners=function(e){return Xi(this,e,!1)},De.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Ji.call(t,e)},De.prototype.listenerCount=Ji;function Ji(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}De.prototype.eventNames=function(){return this._eventsCount>0?Vr(this._events):[]};function Zi(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function pc(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function gc(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function _c(t,e){return new Promise(function(r,n){function i(a){t.removeListener(e,s),n(a)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Qi(t,e,s,{once:!0}),e!=="error"&&yc(t,i,{once:!0})})}function yc(t,e,r){typeof t.on=="function"&&Qi(t,"error",e,r)}function Qi(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Wr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var In=function(t,e){return In=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},In(t,e)};function bc(t,e){In(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Tn=function(){return Tn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Tn.apply(this,arguments)};function wc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function vc(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(i<3?a(s):i>3?a(e,r,s):a(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function mc(t,e){return function(r,n){e(r,n,t)}}function Ec(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Sc(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(l){try{f(n.next(l))}catch(m){a(m)}}function h(l){try{f(n.throw(l))}catch(m){a(m)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(t,e||[])).next())})}function Dc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Oc(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function xc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Nn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function es(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function Ic(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(es(arguments[e]));return t}function Tc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function dr(t){return this instanceof dr?(this.v=t,this):new dr(t)}function Nc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(y){return new Promise(function(S,P){s.push([b,y,S,P])>1||c(b,y)})})}function c(b,y){try{h(n[b](y))}catch(S){m(s[0][3],S)}}function h(b){b.value instanceof dr?Promise.resolve(b.value.v).then(f,l):m(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function m(b,y){b(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Ac(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(a){return(r=!r)?{value:dr(t[i](a)),done:i==="return"}:s?s(a):a}:s}}function Pc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Nn=="function"?Nn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),i(c,h,a.done,a.value)})}}function i(s,a,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},a)}}function Rc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Cc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Lc(t){return t&&t.__esModule?t:{default:t}}function Fc(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Uc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var $c=Object.freeze({__proto__:null,__extends:bc,get __assign(){return Tn},__rest:wc,__decorate:vc,__param:mc,__metadata:Ec,__awaiter:Sc,__generator:Dc,__createBinding:Oc,__exportStar:xc,__values:Nn,__read:es,__spread:Ic,__spreadArrays:Tc,__await:dr,__asyncGenerator:Nc,__asyncDelegator:Ac,__asyncValues:Pc,__makeTemplateObject:Rc,__importStar:Cc,__importDefault:Lc,__classPrivateFieldGet:Fc,__classPrivateFieldSet:Uc}),ts=Kt($c),pr={};Object.defineProperty(pr,"__esModule",{value:!0});function Mc(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}pr.safeJsonParse=Mc;function jc(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}pr.safeJsonStringify=jc;var gr={exports:{}},rs;function zc(){return rs||(rs=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof et<"u"&&et.localStorage?gr.exports=et.localStorage:typeof window<"u"&&window.localStorage?gr.exports=window.localStorage:gr.exports=new e}()),gr.exports}var An={},_r={},ns;function Bc(){if(ns)return _r;ns=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.IKeyValueStorage=void 0;class t{}return _r.IKeyValueStorage=t,_r}var yr={},is;function qc(){if(is)return yr;is=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.parseEntry=void 0;const t=pr;function e(r){var n;return[r[0],t.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return yr.parseEntry=e,yr}var ss;function Kc(){return ss||(ss=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ts;e.__exportStar(Bc(),t),e.__exportStar(qc(),t)}(An)),An}Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.KeyValueStorage=void 0;const sr=ts,os=pr,Hc=sr.__importDefault(zc()),Vc=Kc();class as{constructor(){this.localStorage=Hc.default}getKeys(){return sr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return sr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Vc.parseEntry)})}getItem(e){return sr.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return os.safeJsonParse(r)})}setItem(e,r){return sr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,os.safeJsonStringify(r))})}removeItem(e){return sr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Wr.KeyValueStorage=as;var Gc=Wr.default=as,br={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Pn=function(t,e){return Pn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Pn(t,e)};function Wc(t,e){Pn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Rn=function(){return Rn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Rn.apply(this,arguments)};function Yc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function kc(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(i<3?a(s):i>3?a(e,r,s):a(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Xc(t,e){return function(r,n){e(r,n,t)}}function Jc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Zc(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(l){try{f(n.next(l))}catch(m){a(m)}}function h(l){try{f(n.throw(l))}catch(m){a(m)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(t,e||[])).next())})}function Qc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function eu(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function tu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Cn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function cs(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function ru(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(cs(arguments[e]));return t}function nu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function wr(t){return this instanceof wr?(this.v=t,this):new wr(t)}function iu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(y){return new Promise(function(S,P){s.push([b,y,S,P])>1||c(b,y)})})}function c(b,y){try{h(n[b](y))}catch(S){m(s[0][3],S)}}function h(b){b.value instanceof wr?Promise.resolve(b.value.v).then(f,l):m(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function m(b,y){b(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function su(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(a){return(r=!r)?{value:wr(t[i](a)),done:i==="return"}:s?s(a):a}:s}}function ou(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Cn=="function"?Cn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),i(c,h,a.done,a.value)})}}function i(s,a,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},a)}}function au(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function cu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function uu(t){return t&&t.__esModule?t:{default:t}}function fu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function hu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var lu=Object.freeze({__proto__:null,__extends:Wc,get __assign(){return Rn},__rest:Yc,__decorate:kc,__param:Xc,__metadata:Jc,__awaiter:Zc,__generator:Qc,__createBinding:eu,__exportStar:tu,__values:Cn,__read:cs,__spread:ru,__spreadArrays:nu,__await:wr,__asyncGenerator:iu,__asyncDelegator:su,__asyncValues:ou,__makeTemplateObject:au,__importStar:cu,__importDefault:uu,__classPrivateFieldGet:fu,__classPrivateFieldSet:hu}),Yr=Kt(lu),vr={},Z={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Ln=function(t,e){return Ln=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Ln(t,e)};function du(t,e){Ln(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Fn=function(){return Fn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Fn.apply(this,arguments)};function pu(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function gu(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(i<3?a(s):i>3?a(e,r,s):a(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function _u(t,e){return function(r,n){e(r,n,t)}}function yu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function bu(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(l){try{f(n.next(l))}catch(m){a(m)}}function h(l){try{f(n.throw(l))}catch(m){a(m)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(t,e||[])).next())})}function wu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function vu(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function mu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Un(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function us(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function Eu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(us(arguments[e]));return t}function Su(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function mr(t){return this instanceof mr?(this.v=t,this):new mr(t)}function Du(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(y){return new Promise(function(S,P){s.push([b,y,S,P])>1||c(b,y)})})}function c(b,y){try{h(n[b](y))}catch(S){m(s[0][3],S)}}function h(b){b.value instanceof mr?Promise.resolve(b.value.v).then(f,l):m(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function m(b,y){b(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Ou(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(a){return(r=!r)?{value:mr(t[i](a)),done:i==="return"}:s?s(a):a}:s}}function xu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Un=="function"?Un(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),i(c,h,a.done,a.value)})}}function i(s,a,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},a)}}function Iu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Tu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Nu(t){return t&&t.__esModule?t:{default:t}}function Au(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Pu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Ru=Object.freeze({__proto__:null,__extends:du,get __assign(){return Fn},__rest:pu,__decorate:gu,__param:_u,__metadata:yu,__awaiter:bu,__generator:wu,__createBinding:vu,__exportStar:mu,__values:Un,__read:us,__spread:Eu,__spreadArrays:Su,__await:mr,__asyncGenerator:Du,__asyncDelegator:Ou,__asyncValues:xu,__makeTemplateObject:Iu,__importStar:Tu,__importDefault:Nu,__classPrivateFieldGet:Au,__classPrivateFieldSet:Pu}),kr=Kt(Ru),$n={},Er={},fs;function Cu(){if(fs)return Er;fs=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Er.delay=t,Er}var Ht={},Mn={},Vt={},hs;function Lu(){return hs||(hs=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.ONE_THOUSAND=Vt.ONE_HUNDRED=void 0,Vt.ONE_HUNDRED=100,Vt.ONE_THOUSAND=1e3),Vt}var jn={},ls;function Fu(){return ls||(ls=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(jn)),jn}var ds;function ps(){return ds||(ds=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=kr;e.__exportStar(Lu(),t),e.__exportStar(Fu(),t)}(Mn)),Mn}var gs;function Uu(){if(gs)return Ht;gs=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.fromMiliseconds=Ht.toMiliseconds=void 0;const t=ps();function e(n){return n*t.ONE_THOUSAND}Ht.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return Ht.fromMiliseconds=r,Ht}var _s;function $u(){return _s||(_s=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=kr;e.__exportStar(Cu(),t),e.__exportStar(Uu(),t)}($n)),$n}var or={},ys;function Mu(){if(ys)return or;ys=1,Object.defineProperty(or,"__esModule",{value:!0}),or.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return or.Watch=t,or.default=t,or}var zn={},Sr={},bs;function ju(){if(bs)return Sr;bs=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.IWatch=void 0;class t{}return Sr.IWatch=t,Sr}var ws;function zu(){return ws||(ws=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),kr.__exportStar(ju(),t)}(zn)),zn}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=kr;e.__exportStar($u(),t),e.__exportStar(Mu(),t),e.__exportStar(zu(),t),e.__exportStar(ps(),t)})(Z);var Bn={},Dr={};class Gt{}var Bu=Object.freeze({__proto__:null,IEvents:Gt}),qu=Kt(Bu),vs;function Ku(){if(vs)return Dr;vs=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.IHeartBeat=void 0;const t=qu;class e extends t.IEvents{constructor(n){super()}}return Dr.IHeartBeat=e,Dr}var ms;function Es(){return ms||(ms=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Yr.__exportStar(Ku(),t)}(Bn)),Bn}var qn={},Wt={},Ss;function Hu(){if(Ss)return Wt;Ss=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.HEARTBEAT_EVENTS=Wt.HEARTBEAT_INTERVAL=void 0;const t=Z;return Wt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Wt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Wt}var Ds;function Os(){return Ds||(Ds=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Yr.__exportStar(Hu(),t)}(qn)),qn}var xs;function Vu(){if(xs)return vr;xs=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.HeartBeat=void 0;const t=Yr,e=ut.exports,r=Z,n=Es(),i=Os();class s extends n.IHeartBeat{constructor(c){super(c),this.events=new e.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=c?.interval||i.HEARTBEAT_INTERVAL}static init(c){return t.__awaiter(this,void 0,void 0,function*(){const h=new s(c);return yield h.init(),h})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(c,h){this.events.on(c,h)}once(c,h){this.events.once(c,h)}off(c,h){this.events.off(c,h)}removeListener(c,h){this.events.removeListener(c,h)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return vr.HeartBeat=s,vr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Yr;e.__exportStar(Vu(),t),e.__exportStar(Es(),t),e.__exportStar(Os(),t)})(br);var Oe={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Kn=function(t,e){return Kn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Kn(t,e)};function Gu(t,e){Kn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Hn=function(){return Hn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Hn.apply(this,arguments)};function Wu(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Yu(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(i<3?a(s):i>3?a(e,r,s):a(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function ku(t,e){return function(r,n){e(r,n,t)}}function Xu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Ju(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(l){try{f(n.next(l))}catch(m){a(m)}}function h(l){try{f(n.throw(l))}catch(m){a(m)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(t,e||[])).next())})}function Zu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Qu(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function ef(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Vn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Is(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function tf(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Is(arguments[e]));return t}function rf(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function Or(t){return this instanceof Or?(this.v=t,this):new Or(t)}function nf(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(y){return new Promise(function(S,P){s.push([b,y,S,P])>1||c(b,y)})})}function c(b,y){try{h(n[b](y))}catch(S){m(s[0][3],S)}}function h(b){b.value instanceof Or?Promise.resolve(b.value.v).then(f,l):m(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function m(b,y){b(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function sf(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(a){return(r=!r)?{value:Or(t[i](a)),done:i==="return"}:s?s(a):a}:s}}function of(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Vn=="function"?Vn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),i(c,h,a.done,a.value)})}}function i(s,a,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},a)}}function af(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function cf(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function uf(t){return t&&t.__esModule?t:{default:t}}function ff(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function hf(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var lf=Object.freeze({__proto__:null,__extends:Gu,get __assign(){return Hn},__rest:Wu,__decorate:Yu,__param:ku,__metadata:Xu,__awaiter:Ju,__generator:Zu,__createBinding:Qu,__exportStar:ef,__values:Vn,__read:Is,__spread:tf,__spreadArrays:rf,__await:Or,__asyncGenerator:nf,__asyncDelegator:sf,__asyncValues:of,__makeTemplateObject:af,__importStar:cf,__importDefault:uf,__classPrivateFieldGet:ff,__classPrivateFieldSet:hf}),df=Kt(lf),Yt={},Ts;function Ns(){return Ts||(Ts=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.PINO_CUSTOM_CONTEXT_KEY=Yt.PINO_LOGGER_DEFAULTS=void 0,Yt.PINO_LOGGER_DEFAULTS={level:"info"},Yt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Yt}var ot={},As;function pf(){if(As)return ot;As=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.generateChildLogger=ot.formatChildLoggerContext=ot.getLoggerContext=ot.setBrowserLoggerContext=ot.getBrowserLoggerContext=ot.getDefaultLoggerOptions=void 0;const t=Ns();function e(c){return Object.assign(Object.assign({},c),{level:c?.level||t.PINO_LOGGER_DEFAULTS.level})}ot.getDefaultLoggerOptions=e;function r(c,h=t.PINO_CUSTOM_CONTEXT_KEY){return c[h]||""}ot.getBrowserLoggerContext=r;function n(c,h,f=t.PINO_CUSTOM_CONTEXT_KEY){return c[f]=h,c}ot.setBrowserLoggerContext=n;function i(c,h=t.PINO_CUSTOM_CONTEXT_KEY){let f="";return typeof c.bindings>"u"?f=r(c,h):f=c.bindings().context||"",f}ot.getLoggerContext=i;function s(c,h,f=t.PINO_CUSTOM_CONTEXT_KEY){const l=i(c,f);return l.trim()?`${l}/${h}`:h}ot.formatChildLoggerContext=s;function a(c,h,f=t.PINO_CUSTOM_CONTEXT_KEY){const l=s(c,h,f),m=c.child({context:l});return n(m,l,f)}return ot.generateChildLogger=a,ot}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=df,r=e.__importDefault(qr);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Ns(),t),e.__exportStar(pf(),t)})(Oe);class gf extends Gt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class _f extends Gt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class yf{constructor(e,r){this.logger=e,this.core=r}}class bf extends Gt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class wf extends Gt{constructor(e){super()}}class vf{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}class mf extends Gt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Ef extends Gt{constructor(e,r){super(),this.core=e,this.logger=r}}class Sf{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class Df{constructor(e){this.client=e}}function Ps(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function Gn(t){return typeof t=="string"?t:JSON.stringify(t)}var Wn={},ar={},Xr={},Jr={};Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.BrowserRandomSource=void 0;const Rs=65536;class Of{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let n=0;n<r.length;n+=Rs)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,Rs)));return r}}Jr.BrowserRandomSource=Of;function xf(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Zr={},pt={};Object.defineProperty(pt,"__esModule",{value:!0});function If(t){for(var e=0;e<t.length;e++)t[e]=0;return t}pt.wipe=If;var Tf={},Nf=Object.freeze({__proto__:null,default:Tf}),Af=Kt(Nf);Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.NodeRandomSource=void 0;const Pf=pt;class Rf{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof xf<"u"){const e=Af;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,Pf.wipe)(r),n}}Zr.NodeRandomSource=Rf,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.SystemRandomSource=void 0;const Cf=Jr,Lf=Zr;class Ff{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Cf.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Lf.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Xr.SystemRandomSource=Ff;var te={},Cs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,h){var f=c>>>16&65535,l=c&65535,m=h>>>16&65535,b=h&65535;return l*b+(f*b+l*m<<16>>>0)|0}t.mul=Math.imul||e;function r(c,h){return c+h|0}t.add=r;function n(c,h){return c-h|0}t.sub=n;function i(c,h){return c<<h|c>>>32-h}t.rotl=i;function s(c,h){return c<<32-h|c>>>h}t.rotr=s;function a(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}t.isInteger=Number.isInteger||a,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(c){return t.isInteger(c)&&c>=-t.MAX_SAFE_INTEGER&&c<=t.MAX_SAFE_INTEGER}})(Cs),Object.defineProperty(te,"__esModule",{value:!0});var Ls=Cs;function Uf(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}te.readInt16BE=Uf;function $f(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}te.readUint16BE=$f;function Mf(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}te.readInt16LE=Mf;function jf(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}te.readUint16LE=jf;function Fs(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}te.writeUint16BE=Fs,te.writeInt16BE=Fs;function Us(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}te.writeUint16LE=Us,te.writeInt16LE=Us;function Yn(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}te.readInt32BE=Yn;function kn(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}te.readUint32BE=kn;function Xn(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}te.readInt32LE=Xn;function Jn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}te.readUint32LE=Jn;function Qr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}te.writeUint32BE=Qr,te.writeInt32BE=Qr;function en(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}te.writeUint32LE=en,te.writeInt32LE=en;function zf(t,e){e===void 0&&(e=0);var r=Yn(t,e),n=Yn(t,e+4);return r*4294967296+n-(n>>31)*4294967296}te.readInt64BE=zf;function Bf(t,e){e===void 0&&(e=0);var r=kn(t,e),n=kn(t,e+4);return r*4294967296+n}te.readUint64BE=Bf;function qf(t,e){e===void 0&&(e=0);var r=Xn(t,e),n=Xn(t,e+4);return n*4294967296+r-(r>>31)*4294967296}te.readInt64LE=qf;function Kf(t,e){e===void 0&&(e=0);var r=Jn(t,e),n=Jn(t,e+4);return n*4294967296+r}te.readUint64LE=Kf;function $s(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Qr(t/4294967296>>>0,e,r),Qr(t>>>0,e,r+4),e}te.writeUint64BE=$s,te.writeInt64BE=$s;function Ms(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),en(t>>>0,e,r),en(t/4294967296>>>0,e,r+4),e}te.writeUint64LE=Ms,te.writeInt64LE=Ms;function Hf(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=t/8+r-1;s>=r;s--)n+=e[s]*i,i*=256;return n}te.readUintBE=Hf;function Vf(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+t/8;s++)n+=e[s]*i,i*=256;return n}te.readUintLE=Vf;function Gf(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Ls.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,s=t/8+n-1;s>=n;s--)r[s]=e/i&255,i*=256;return r}te.writeUintBE=Gf;function Wf(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Ls.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+t/8;s++)r[s]=e/i&255,i*=256;return r}te.writeUintLE=Wf;function Yf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}te.readFloat32BE=Yf;function kf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}te.readFloat32LE=kf;function Xf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}te.readFloat64BE=Xf;function Jf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}te.readFloat64LE=Jf;function Zf(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t),e}te.writeFloat32BE=Zf;function Qf(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t,!0),e}te.writeFloat32LE=Qf;function eh(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t),e}te.writeFloat64BE=eh;function th(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t,!0),e}te.writeFloat64LE=th,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=Xr,r=te,n=pt;t.defaultRandomSource=new e.SystemRandomSource;function i(f,l=t.defaultRandomSource){return l.randomBytes(f)}t.randomBytes=i;function s(f=t.defaultRandomSource){const l=i(4,f),m=(0,r.readUint32LE)(l);return(0,n.wipe)(l),m}t.randomUint32=s;const a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(f,l=a,m=t.defaultRandomSource){if(l.length<2)throw new Error("randomString charset is too short");if(l.length>256)throw new Error("randomString charset is too long");let b="";const y=l.length,S=256-256%y;for(;f>0;){const P=i(Math.ceil(f*256/S),m);for(let R=0;R<P.length&&f>0;R++){const j=P[R];j<S&&(b+=l.charAt(j%y),f--)}(0,n.wipe)(P)}return b}t.randomString=c;function h(f,l=a,m=t.defaultRandomSource){const b=Math.ceil(f/(Math.log(l.length)/Math.LN2));return c(b,l,m)}t.randomStringForEntropy=h}(ar);var js={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=te,r=pt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var n=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},c.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var l=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&f>0;)this._buffer[this._bufferLength++]=h[l++],f--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(l=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,l,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[l++],f--;return this},c.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,l=this._bufferLength,m=f/536870912|0,b=f<<3,y=f%128<112?128:256;this._buffer[l]=128;for(var S=l+1;S<y-8;S++)this._buffer[S]=0;e.writeUint32BE(m,this._buffer,y-8),e.writeUint32BE(b,this._buffer,y-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,y),this._finished=!0}for(var S=0;S<this.digestLength/8;S++)e.writeUint32BE(this._stateHi[S],h,S*8),e.writeUint32BE(this._stateLo[S],h,S*8+4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();t.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(c,h,f,l,m,b,y){for(var S=f[0],P=f[1],R=f[2],j=f[3],E=f[4],x=f[5],g=f[6],v=f[7],w=l[0],o=l[1],p=l[2],F=l[3],z=l[4],k=l[5],X=l[6],J=l[7],A,N,W,M,L,U,$,B;y>=128;){for(var ne=0;ne<16;ne++){var q=8*ne+b;c[ne]=e.readUint32BE(m,q),h[ne]=e.readUint32BE(m,q+4)}for(var ne=0;ne<80;ne++){var Q=S,Y=P,ae=R,T=j,I=E,D=x,u=g,_=v,K=w,V=o,he=p,ye=F,de=z,ve=k,Ue=X,Pe=J;if(A=v,N=J,L=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=(E>>>14|z<<32-14)^(E>>>18|z<<32-18)^(z>>>41-32|E<<32-(41-32)),N=(z>>>14|E<<32-14)^(z>>>18|E<<32-18)^(E>>>41-32|z<<32-(41-32)),L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,A=E&x^~E&g,N=z&k^~z&X,L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,A=i[ne*2],N=i[ne*2+1],L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,A=c[ne%16],N=h[ne%16],L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=L>>>16,$+=U>>>16,B+=$>>>16,W=$&65535|B<<16,M=L&65535|U<<16,A=W,N=M,L=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=(S>>>28|w<<32-28)^(w>>>34-32|S<<32-(34-32))^(w>>>39-32|S<<32-(39-32)),N=(w>>>28|S<<32-28)^(S>>>34-32|w<<32-(34-32))^(S>>>39-32|w<<32-(39-32)),L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,A=S&P^S&R^P&R,N=w&o^w&p^o&p,L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=L>>>16,$+=U>>>16,B+=$>>>16,_=$&65535|B<<16,Pe=L&65535|U<<16,A=T,N=ye,L=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=W,N=M,L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=L>>>16,$+=U>>>16,B+=$>>>16,T=$&65535|B<<16,ye=L&65535|U<<16,P=Q,R=Y,j=ae,E=T,x=I,g=D,v=u,S=_,o=K,p=V,F=he,z=ye,k=de,X=ve,J=Ue,w=Pe,ne%16===15)for(var q=0;q<16;q++)A=c[q],N=h[q],L=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=c[(q+9)%16],N=h[(q+9)%16],L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,W=c[(q+1)%16],M=h[(q+1)%16],A=(W>>>1|M<<32-1)^(W>>>8|M<<32-8)^W>>>7,N=(M>>>1|W<<32-1)^(M>>>8|W<<32-8)^(M>>>7|W<<32-7),L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,W=c[(q+14)%16],M=h[(q+14)%16],A=(W>>>19|M<<32-19)^(M>>>61-32|W<<32-(61-32))^W>>>6,N=(M>>>19|W<<32-19)^(W>>>61-32|M<<32-(61-32))^(M>>>6|W<<32-6),L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=L>>>16,$+=U>>>16,B+=$>>>16,c[q]=$&65535|B<<16,h[q]=L&65535|U<<16}A=S,N=w,L=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[0],N=l[0],L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=L>>>16,$+=U>>>16,B+=$>>>16,f[0]=S=$&65535|B<<16,l[0]=w=L&65535|U<<16,A=P,N=o,L=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[1],N=l[1],L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=L>>>16,$+=U>>>16,B+=$>>>16,f[1]=P=$&65535|B<<16,l[1]=o=L&65535|U<<16,A=R,N=p,L=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[2],N=l[2],L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=L>>>16,$+=U>>>16,B+=$>>>16,f[2]=R=$&65535|B<<16,l[2]=p=L&65535|U<<16,A=j,N=F,L=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[3],N=l[3],L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=L>>>16,$+=U>>>16,B+=$>>>16,f[3]=j=$&65535|B<<16,l[3]=F=L&65535|U<<16,A=E,N=z,L=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[4],N=l[4],L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=L>>>16,$+=U>>>16,B+=$>>>16,f[4]=E=$&65535|B<<16,l[4]=z=L&65535|U<<16,A=x,N=k,L=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[5],N=l[5],L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=L>>>16,$+=U>>>16,B+=$>>>16,f[5]=x=$&65535|B<<16,l[5]=k=L&65535|U<<16,A=g,N=X,L=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[6],N=l[6],L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=L>>>16,$+=U>>>16,B+=$>>>16,f[6]=g=$&65535|B<<16,l[6]=X=L&65535|U<<16,A=v,N=J,L=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[7],N=l[7],L+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=L>>>16,$+=U>>>16,B+=$>>>16,f[7]=v=$&65535|B<<16,l[7]=J=L&65535|U<<16,b+=128,y-=128}return b}function a(c){var h=new n;h.update(c);var f=h.digest();return h.clean(),f}t.hash=a})(js),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=ar,r=js,n=pt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function i(T){const I=new Float64Array(16);if(T)for(let D=0;D<T.length;D++)I[D]=T[D];return I}const s=new Uint8Array(32);s[0]=9;const a=i(),c=i([1]),h=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),f=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),b=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function y(T,I){for(let D=0;D<16;D++)T[D]=I[D]|0}function S(T){let I=1;for(let D=0;D<16;D++){let u=T[D]+I+65535;I=Math.floor(u/65536),T[D]=u-I*65536}T[0]+=I-1+37*(I-1)}function P(T,I,D){const u=~(D-1);for(let _=0;_<16;_++){const K=u&(T[_]^I[_]);T[_]^=K,I[_]^=K}}function R(T,I){const D=i(),u=i();for(let _=0;_<16;_++)u[_]=I[_];S(u),S(u),S(u);for(let _=0;_<2;_++){D[0]=u[0]-65517;for(let V=1;V<15;V++)D[V]=u[V]-65535-(D[V-1]>>16&1),D[V-1]&=65535;D[15]=u[15]-32767-(D[14]>>16&1);const K=D[15]>>16&1;D[14]&=65535,P(u,D,1-K)}for(let _=0;_<16;_++)T[2*_]=u[_]&255,T[2*_+1]=u[_]>>8}function j(T,I){let D=0;for(let u=0;u<32;u++)D|=T[u]^I[u];return(1&D-1>>>8)-1}function E(T,I){const D=new Uint8Array(32),u=new Uint8Array(32);return R(D,T),R(u,I),j(D,u)}function x(T){const I=new Uint8Array(32);return R(I,T),I[0]&1}function g(T,I){for(let D=0;D<16;D++)T[D]=I[2*D]+(I[2*D+1]<<8);T[15]&=32767}function v(T,I,D){for(let u=0;u<16;u++)T[u]=I[u]+D[u]}function w(T,I,D){for(let u=0;u<16;u++)T[u]=I[u]-D[u]}function o(T,I,D){let u,_,K=0,V=0,he=0,ye=0,de=0,ve=0,Ue=0,Pe=0,_e=0,pe=0,le=0,ue=0,ce=0,oe=0,se=0,ee=0,fe=0,ge=0,re=0,be=0,we=0,Ee=0,Se=0,me=0,Et=0,Nt=0,jt=0,gt=0,Zt=0,jr=0,bn=0,$e=D[0],Re=D[1],Me=D[2],je=D[3],ze=D[4],Ce=D[5],Ge=D[6],We=D[7],Ye=D[8],ke=D[9],Xe=D[10],qe=D[11],Be=D[12],Ne=D[13],Je=D[14],Ze=D[15];u=I[0],K+=u*$e,V+=u*Re,he+=u*Me,ye+=u*je,de+=u*ze,ve+=u*Ce,Ue+=u*Ge,Pe+=u*We,_e+=u*Ye,pe+=u*ke,le+=u*Xe,ue+=u*qe,ce+=u*Be,oe+=u*Ne,se+=u*Je,ee+=u*Ze,u=I[1],V+=u*$e,he+=u*Re,ye+=u*Me,de+=u*je,ve+=u*ze,Ue+=u*Ce,Pe+=u*Ge,_e+=u*We,pe+=u*Ye,le+=u*ke,ue+=u*Xe,ce+=u*qe,oe+=u*Be,se+=u*Ne,ee+=u*Je,fe+=u*Ze,u=I[2],he+=u*$e,ye+=u*Re,de+=u*Me,ve+=u*je,Ue+=u*ze,Pe+=u*Ce,_e+=u*Ge,pe+=u*We,le+=u*Ye,ue+=u*ke,ce+=u*Xe,oe+=u*qe,se+=u*Be,ee+=u*Ne,fe+=u*Je,ge+=u*Ze,u=I[3],ye+=u*$e,de+=u*Re,ve+=u*Me,Ue+=u*je,Pe+=u*ze,_e+=u*Ce,pe+=u*Ge,le+=u*We,ue+=u*Ye,ce+=u*ke,oe+=u*Xe,se+=u*qe,ee+=u*Be,fe+=u*Ne,ge+=u*Je,re+=u*Ze,u=I[4],de+=u*$e,ve+=u*Re,Ue+=u*Me,Pe+=u*je,_e+=u*ze,pe+=u*Ce,le+=u*Ge,ue+=u*We,ce+=u*Ye,oe+=u*ke,se+=u*Xe,ee+=u*qe,fe+=u*Be,ge+=u*Ne,re+=u*Je,be+=u*Ze,u=I[5],ve+=u*$e,Ue+=u*Re,Pe+=u*Me,_e+=u*je,pe+=u*ze,le+=u*Ce,ue+=u*Ge,ce+=u*We,oe+=u*Ye,se+=u*ke,ee+=u*Xe,fe+=u*qe,ge+=u*Be,re+=u*Ne,be+=u*Je,we+=u*Ze,u=I[6],Ue+=u*$e,Pe+=u*Re,_e+=u*Me,pe+=u*je,le+=u*ze,ue+=u*Ce,ce+=u*Ge,oe+=u*We,se+=u*Ye,ee+=u*ke,fe+=u*Xe,ge+=u*qe,re+=u*Be,be+=u*Ne,we+=u*Je,Ee+=u*Ze,u=I[7],Pe+=u*$e,_e+=u*Re,pe+=u*Me,le+=u*je,ue+=u*ze,ce+=u*Ce,oe+=u*Ge,se+=u*We,ee+=u*Ye,fe+=u*ke,ge+=u*Xe,re+=u*qe,be+=u*Be,we+=u*Ne,Ee+=u*Je,Se+=u*Ze,u=I[8],_e+=u*$e,pe+=u*Re,le+=u*Me,ue+=u*je,ce+=u*ze,oe+=u*Ce,se+=u*Ge,ee+=u*We,fe+=u*Ye,ge+=u*ke,re+=u*Xe,be+=u*qe,we+=u*Be,Ee+=u*Ne,Se+=u*Je,me+=u*Ze,u=I[9],pe+=u*$e,le+=u*Re,ue+=u*Me,ce+=u*je,oe+=u*ze,se+=u*Ce,ee+=u*Ge,fe+=u*We,ge+=u*Ye,re+=u*ke,be+=u*Xe,we+=u*qe,Ee+=u*Be,Se+=u*Ne,me+=u*Je,Et+=u*Ze,u=I[10],le+=u*$e,ue+=u*Re,ce+=u*Me,oe+=u*je,se+=u*ze,ee+=u*Ce,fe+=u*Ge,ge+=u*We,re+=u*Ye,be+=u*ke,we+=u*Xe,Ee+=u*qe,Se+=u*Be,me+=u*Ne,Et+=u*Je,Nt+=u*Ze,u=I[11],ue+=u*$e,ce+=u*Re,oe+=u*Me,se+=u*je,ee+=u*ze,fe+=u*Ce,ge+=u*Ge,re+=u*We,be+=u*Ye,we+=u*ke,Ee+=u*Xe,Se+=u*qe,me+=u*Be,Et+=u*Ne,Nt+=u*Je,jt+=u*Ze,u=I[12],ce+=u*$e,oe+=u*Re,se+=u*Me,ee+=u*je,fe+=u*ze,ge+=u*Ce,re+=u*Ge,be+=u*We,we+=u*Ye,Ee+=u*ke,Se+=u*Xe,me+=u*qe,Et+=u*Be,Nt+=u*Ne,jt+=u*Je,gt+=u*Ze,u=I[13],oe+=u*$e,se+=u*Re,ee+=u*Me,fe+=u*je,ge+=u*ze,re+=u*Ce,be+=u*Ge,we+=u*We,Ee+=u*Ye,Se+=u*ke,me+=u*Xe,Et+=u*qe,Nt+=u*Be,jt+=u*Ne,gt+=u*Je,Zt+=u*Ze,u=I[14],se+=u*$e,ee+=u*Re,fe+=u*Me,ge+=u*je,re+=u*ze,be+=u*Ce,we+=u*Ge,Ee+=u*We,Se+=u*Ye,me+=u*ke,Et+=u*Xe,Nt+=u*qe,jt+=u*Be,gt+=u*Ne,Zt+=u*Je,jr+=u*Ze,u=I[15],ee+=u*$e,fe+=u*Re,ge+=u*Me,re+=u*je,be+=u*ze,we+=u*Ce,Ee+=u*Ge,Se+=u*We,me+=u*Ye,Et+=u*ke,Nt+=u*Xe,jt+=u*qe,gt+=u*Be,Zt+=u*Ne,jr+=u*Je,bn+=u*Ze,K+=38*fe,V+=38*ge,he+=38*re,ye+=38*be,de+=38*we,ve+=38*Ee,Ue+=38*Se,Pe+=38*me,_e+=38*Et,pe+=38*Nt,le+=38*jt,ue+=38*gt,ce+=38*Zt,oe+=38*jr,se+=38*bn,_=1,u=K+_+65535,_=Math.floor(u/65536),K=u-_*65536,u=V+_+65535,_=Math.floor(u/65536),V=u-_*65536,u=he+_+65535,_=Math.floor(u/65536),he=u-_*65536,u=ye+_+65535,_=Math.floor(u/65536),ye=u-_*65536,u=de+_+65535,_=Math.floor(u/65536),de=u-_*65536,u=ve+_+65535,_=Math.floor(u/65536),ve=u-_*65536,u=Ue+_+65535,_=Math.floor(u/65536),Ue=u-_*65536,u=Pe+_+65535,_=Math.floor(u/65536),Pe=u-_*65536,u=_e+_+65535,_=Math.floor(u/65536),_e=u-_*65536,u=pe+_+65535,_=Math.floor(u/65536),pe=u-_*65536,u=le+_+65535,_=Math.floor(u/65536),le=u-_*65536,u=ue+_+65535,_=Math.floor(u/65536),ue=u-_*65536,u=ce+_+65535,_=Math.floor(u/65536),ce=u-_*65536,u=oe+_+65535,_=Math.floor(u/65536),oe=u-_*65536,u=se+_+65535,_=Math.floor(u/65536),se=u-_*65536,u=ee+_+65535,_=Math.floor(u/65536),ee=u-_*65536,K+=_-1+37*(_-1),_=1,u=K+_+65535,_=Math.floor(u/65536),K=u-_*65536,u=V+_+65535,_=Math.floor(u/65536),V=u-_*65536,u=he+_+65535,_=Math.floor(u/65536),he=u-_*65536,u=ye+_+65535,_=Math.floor(u/65536),ye=u-_*65536,u=de+_+65535,_=Math.floor(u/65536),de=u-_*65536,u=ve+_+65535,_=Math.floor(u/65536),ve=u-_*65536,u=Ue+_+65535,_=Math.floor(u/65536),Ue=u-_*65536,u=Pe+_+65535,_=Math.floor(u/65536),Pe=u-_*65536,u=_e+_+65535,_=Math.floor(u/65536),_e=u-_*65536,u=pe+_+65535,_=Math.floor(u/65536),pe=u-_*65536,u=le+_+65535,_=Math.floor(u/65536),le=u-_*65536,u=ue+_+65535,_=Math.floor(u/65536),ue=u-_*65536,u=ce+_+65535,_=Math.floor(u/65536),ce=u-_*65536,u=oe+_+65535,_=Math.floor(u/65536),oe=u-_*65536,u=se+_+65535,_=Math.floor(u/65536),se=u-_*65536,u=ee+_+65535,_=Math.floor(u/65536),ee=u-_*65536,K+=_-1+37*(_-1),T[0]=K,T[1]=V,T[2]=he,T[3]=ye,T[4]=de,T[5]=ve,T[6]=Ue,T[7]=Pe,T[8]=_e,T[9]=pe,T[10]=le,T[11]=ue,T[12]=ce,T[13]=oe,T[14]=se,T[15]=ee}function p(T,I){o(T,I,I)}function F(T,I){const D=i();let u;for(u=0;u<16;u++)D[u]=I[u];for(u=253;u>=0;u--)p(D,D),u!==2&&u!==4&&o(D,D,I);for(u=0;u<16;u++)T[u]=D[u]}function z(T,I){const D=i();let u;for(u=0;u<16;u++)D[u]=I[u];for(u=250;u>=0;u--)p(D,D),u!==1&&o(D,D,I);for(u=0;u<16;u++)T[u]=D[u]}function k(T,I){const D=i(),u=i(),_=i(),K=i(),V=i(),he=i(),ye=i(),de=i(),ve=i();w(D,T[1],T[0]),w(ve,I[1],I[0]),o(D,D,ve),v(u,T[0],T[1]),v(ve,I[0],I[1]),o(u,u,ve),o(_,T[3],I[3]),o(_,_,f),o(K,T[2],I[2]),v(K,K,K),w(V,u,D),w(he,K,_),v(ye,K,_),v(de,u,D),o(T[0],V,he),o(T[1],de,ye),o(T[2],ye,he),o(T[3],V,de)}function X(T,I,D){for(let u=0;u<4;u++)P(T[u],I[u],D)}function J(T,I){const D=i(),u=i(),_=i();F(_,I[2]),o(D,I[0],_),o(u,I[1],_),R(T,u),T[31]^=x(D)<<7}function A(T,I,D){y(T[0],a),y(T[1],c),y(T[2],c),y(T[3],a);for(let u=255;u>=0;--u){const _=D[u/8|0]>>(u&7)&1;X(T,I,_),k(I,T),k(T,T),X(T,I,_)}}function N(T,I){const D=[i(),i(),i(),i()];y(D[0],l),y(D[1],m),y(D[2],c),o(D[3],l,m),A(T,D,I)}function W(T){if(T.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const I=(0,r.hash)(T);I[0]&=248,I[31]&=127,I[31]|=64;const D=new Uint8Array(32),u=[i(),i(),i(),i()];N(u,I),J(D,u);const _=new Uint8Array(64);return _.set(T),_.set(D,32),{publicKey:D,secretKey:_}}t.generateKeyPairFromSeed=W;function M(T){const I=(0,e.randomBytes)(32,T),D=W(I);return(0,n.wipe)(I),D}t.generateKeyPair=M;function L(T){if(T.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(T.subarray(32))}t.extractPublicKeyFromSecretKey=L;const U=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function $(T,I){let D,u,_,K;for(u=63;u>=32;--u){for(D=0,_=u-32,K=u-12;_<K;++_)I[_]+=D-16*I[u]*U[_-(u-32)],D=Math.floor((I[_]+128)/256),I[_]-=D*256;I[_]+=D,I[u]=0}for(D=0,_=0;_<32;_++)I[_]+=D-(I[31]>>4)*U[_],D=I[_]>>8,I[_]&=255;for(_=0;_<32;_++)I[_]-=D*U[_];for(u=0;u<32;u++)I[u+1]+=I[u]>>8,T[u]=I[u]&255}function B(T){const I=new Float64Array(64);for(let D=0;D<64;D++)I[D]=T[D];for(let D=0;D<64;D++)T[D]=0;$(T,I)}function ne(T,I){const D=new Float64Array(64),u=[i(),i(),i(),i()],_=(0,r.hash)(T.subarray(0,32));_[0]&=248,_[31]&=127,_[31]|=64;const K=new Uint8Array(64);K.set(_.subarray(32),32);const V=new r.SHA512;V.update(K.subarray(32)),V.update(I);const he=V.digest();V.clean(),B(he),N(u,he),J(K,u),V.reset(),V.update(K.subarray(0,32)),V.update(T.subarray(32)),V.update(I);const ye=V.digest();B(ye);for(let de=0;de<32;de++)D[de]=he[de];for(let de=0;de<32;de++)for(let ve=0;ve<32;ve++)D[de+ve]+=ye[de]*_[ve];return $(K.subarray(32),D),K}t.sign=ne;function q(T,I){const D=i(),u=i(),_=i(),K=i(),V=i(),he=i(),ye=i();return y(T[2],c),g(T[1],I),p(_,T[1]),o(K,_,h),w(_,_,T[2]),v(K,T[2],K),p(V,K),p(he,V),o(ye,he,V),o(D,ye,_),o(D,D,K),z(D,D),o(D,D,_),o(D,D,K),o(D,D,K),o(T[0],D,K),p(u,T[0]),o(u,u,K),E(u,_)&&o(T[0],T[0],b),p(u,T[0]),o(u,u,K),E(u,_)?-1:(x(T[0])===I[31]>>7&&w(T[0],a,T[0]),o(T[3],T[0],T[1]),0)}function Q(T,I,D){const u=new Uint8Array(32),_=[i(),i(),i(),i()],K=[i(),i(),i(),i()];if(D.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(q(K,T))return!1;const V=new r.SHA512;V.update(D.subarray(0,32)),V.update(T),V.update(I);const he=V.digest();return B(he),A(_,K,he),N(K,D.subarray(32)),k(_,K),J(u,_),!j(D,u)}t.verify=Q;function Y(T){let I=[i(),i(),i(),i()];if(q(I,T))throw new Error("Ed25519: invalid public key");let D=i(),u=i(),_=I[1];v(D,c,_),w(u,c,_),F(u,u),o(D,D,u);let K=new Uint8Array(32);return R(K,D),K}t.convertPublicKeyToX25519=Y;function ae(T){const I=(0,r.hash)(T.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const D=new Uint8Array(I.subarray(0,32));return(0,n.wipe)(I),D}t.convertSecretKeyToX25519=ae}(Wn);const rh="EdDSA",nh="JWT",zs=".",Bs="base64url",ih="utf8",sh="utf8",oh=":",ah="did",ch="key",qs="base58btc",uh="z",fh="K36",hh=32;function Ks(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Zn(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=Ks(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}function lh(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var c=t.length,h=t.charAt(0),f=Math.log(c)/Math.log(256),l=Math.log(256)/Math.log(c);function m(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var P=0,R=0,j=0,E=S.length;j!==E&&S[j]===0;)j++,P++;for(var x=(E-j)*l+1>>>0,g=new Uint8Array(x);j!==E;){for(var v=S[j],w=0,o=x-1;(v!==0||w<R)&&o!==-1;o--,w++)v+=256*g[o]>>>0,g[o]=v%c>>>0,v=v/c>>>0;if(v!==0)throw new Error("Non-zero carry");R=w,j++}for(var p=x-R;p!==x&&g[p]===0;)p++;for(var F=h.repeat(P);p<x;++p)F+=t.charAt(g[p]);return F}function b(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var P=0;if(S[P]!==" "){for(var R=0,j=0;S[P]===h;)R++,P++;for(var E=(S.length-P)*f+1>>>0,x=new Uint8Array(E);S[P];){var g=r[S.charCodeAt(P)];if(g===255)return;for(var v=0,w=E-1;(g!==0||v<j)&&w!==-1;w--,v++)g+=c*x[w]>>>0,x[w]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");j=v,P++}if(S[P]!==" "){for(var o=E-j;o!==E&&x[o]===0;)o++;for(var p=new Uint8Array(R+(E-o)),F=R;o!==E;)p[F++]=x[o++];return p}}}function y(S){var P=b(S);if(P)return P;throw new Error(`Non-${e} character`)}return{encode:m,decodeUnsafe:b,decode:y}}var dh=lh,ph=dh;const Hs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},gh=t=>new TextEncoder().encode(t),_h=t=>new TextDecoder().decode(t);class yh{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class bh{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Vs(this,e)}}class wh{constructor(e){this.decoders=e}or(e){return Vs(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Vs=(t,e)=>new wh({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class vh{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new yh(e,r,n),this.decoder=new bh(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const tn=({name:t,prefix:e,encode:r,decode:n})=>new vh(t,e,r,n),xr=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=ph(r,e);return tn({prefix:t,name:e,encode:n,decode:s=>Hs(i(s))})},mh=(t,e,r,n)=>{const i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,h=0,f=0;for(let l=0;l<s;++l){const m=i[t[l]];if(m===void 0)throw new SyntaxError(`Non-${n} character`);h=h<<r|m,c+=r,c>=8&&(c-=8,a[f++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return a},Eh=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",a=0,c=0;for(let h=0;h<t.length;++h)for(c=c<<8|t[h],a+=8;a>r;)a-=r,s+=e[i&c>>a];if(a&&(s+=e[i&c<<r-a]),n)for(;s.length*r&7;)s+="=";return s},tt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>tn({prefix:e,name:t,encode(i){return Eh(i,n,r)},decode(i){return mh(i,n,r,t)}}),Sh=tn({prefix:"\0",name:"identity",encode:t=>_h(t),decode:t=>gh(t)});var Dh=Object.freeze({__proto__:null,identity:Sh});const Oh=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var xh=Object.freeze({__proto__:null,base2:Oh});const Ih=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Th=Object.freeze({__proto__:null,base8:Ih});const Nh=xr({prefix:"9",name:"base10",alphabet:"0123456789"});var Ah=Object.freeze({__proto__:null,base10:Nh});const Ph=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Rh=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ch=Object.freeze({__proto__:null,base16:Ph,base16upper:Rh});const Lh=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Fh=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Uh=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),$h=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Mh=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),jh=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),zh=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Bh=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qh=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Kh=Object.freeze({__proto__:null,base32:Lh,base32upper:Fh,base32pad:Uh,base32padupper:$h,base32hex:Mh,base32hexupper:jh,base32hexpad:zh,base32hexpadupper:Bh,base32z:qh});const Hh=xr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Vh=xr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Gh=Object.freeze({__proto__:null,base36:Hh,base36upper:Vh});const Wh=xr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Yh=xr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var kh=Object.freeze({__proto__:null,base58btc:Wh,base58flickr:Yh});const Xh=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Jh=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Zh=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Qh=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var el=Object.freeze({__proto__:null,base64:Xh,base64pad:Jh,base64url:Zh,base64urlpad:Qh});const Gs=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),tl=Gs.reduce((t,e,r)=>(t[r]=e,t),[]),rl=Gs.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function nl(t){return t.reduce((e,r)=>(e+=tl[r],e),"")}function il(t){const e=[];for(const r of t){const n=rl[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const sl=tn({prefix:"\u{1F680}",name:"base256emoji",encode:nl,decode:il});var ol=Object.freeze({__proto__:null,base256emoji:sl}),al=Ys,Ws=128,cl=127,ul=~cl,fl=Math.pow(2,31);function Ys(t,e,r){e=e||[],r=r||0;for(var n=r;t>=fl;)e[r++]=t&255|Ws,t/=128;for(;t&ul;)e[r++]=t&255|Ws,t>>>=7;return e[r]=t|0,Ys.bytes=r-n+1,e}var hl=Qn,ll=128,ks=127;function Qn(t,n){var r=0,n=n||0,i=0,s=n,a,c=t.length;do{if(s>=c)throw Qn.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=i<28?(a&ks)<<i:(a&ks)*Math.pow(2,i),i+=7}while(a>=ll);return Qn.bytes=s-n,r}var dl=Math.pow(2,7),pl=Math.pow(2,14),gl=Math.pow(2,21),_l=Math.pow(2,28),yl=Math.pow(2,35),bl=Math.pow(2,42),wl=Math.pow(2,49),vl=Math.pow(2,56),ml=Math.pow(2,63),El=function(t){return t<dl?1:t<pl?2:t<gl?3:t<_l?4:t<yl?5:t<bl?6:t<wl?7:t<vl?8:t<ml?9:10},Sl={encode:al,decode:hl,encodingLength:El},Xs=Sl;const Js=(t,e,r=0)=>(Xs.encode(t,e,r),e),Zs=t=>Xs.encodingLength(t),ei=(t,e)=>{const r=e.byteLength,n=Zs(t),i=n+Zs(r),s=new Uint8Array(i+r);return Js(t,s,0),Js(r,s,n),s.set(e,i),new Dl(t,r,e,s)};class Dl{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const Qs=({name:t,code:e,encode:r})=>new Ol(t,e,r);class Ol{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?ei(this.code,r):r.then(n=>ei(this.code,n))}else throw Error("Unknown type, must be binary type")}}const eo=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),xl=Qs({name:"sha2-256",code:18,encode:eo("SHA-256")}),Il=Qs({name:"sha2-512",code:19,encode:eo("SHA-512")});var Tl=Object.freeze({__proto__:null,sha256:xl,sha512:Il});const to=0,Nl="identity",ro=Hs;var Al=Object.freeze({__proto__:null,identity:{code:to,name:Nl,encode:ro,digest:t=>ei(to,ro(t))}});new TextEncoder,new TextDecoder;const no={...Dh,...xh,...Th,...Ah,...Ch,...Kh,...Gh,...kh,...el,...ol};({...Tl,...Al});function io(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const so=io("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),ti=io("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Ks(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),oo={utf8:so,"utf-8":so,hex:no.base16,latin1:ti,ascii:ti,binary:ti,...no};function ft(t,e="utf8"){const r=oo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function ht(t,e="utf8"){const r=oo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function rn(t){return ft(ht(Gn(t),ih),Bs)}function ao(t){const e=ht(fh,qs),r=uh+ft(Zn([e,t]),qs);return[ah,ch,r].join(oh)}function Pl(t){return ft(t,Bs)}function Rl(t){return ht([rn(t.header),rn(t.payload)].join(zs),sh)}function Cl(t){return[rn(t.header),rn(t.payload),Pl(t.signature)].join(zs)}function co(t=ar.randomBytes(hh)){return Wn.generateKeyPairFromSeed(t)}async function Ll(t,e,r,n,i=Z.fromMiliseconds(Date.now())){const s={alg:rh,typ:nh},a=ao(n.publicKey),c=i+r,h={iss:a,sub:t,aud:e,iat:i,exp:c},f=Rl({header:s,payload:h}),l=Wn.sign(n.secretKey,f);return Cl({header:s,payload:h,signature:l})}var ri={},nn={};Object.defineProperty(nn,"__esModule",{value:!0});var it=te,ni=pt,Fl=20;function Ul(t,e,r){for(var n=1634760805,i=857760878,s=2036477234,a=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],f=r[11]<<24|r[10]<<16|r[9]<<8|r[8],l=r[15]<<24|r[14]<<16|r[13]<<8|r[12],m=r[19]<<24|r[18]<<16|r[17]<<8|r[16],b=r[23]<<24|r[22]<<16|r[21]<<8|r[20],y=r[27]<<24|r[26]<<16|r[25]<<8|r[24],S=r[31]<<24|r[30]<<16|r[29]<<8|r[28],P=e[3]<<24|e[2]<<16|e[1]<<8|e[0],R=e[7]<<24|e[6]<<16|e[5]<<8|e[4],j=e[11]<<24|e[10]<<16|e[9]<<8|e[8],E=e[15]<<24|e[14]<<16|e[13]<<8|e[12],x=n,g=i,v=s,w=a,o=c,p=h,F=f,z=l,k=m,X=b,J=y,A=S,N=P,W=R,M=j,L=E,U=0;U<Fl;U+=2)x=x+o|0,N^=x,N=N>>>32-16|N<<16,k=k+N|0,o^=k,o=o>>>32-12|o<<12,g=g+p|0,W^=g,W=W>>>32-16|W<<16,X=X+W|0,p^=X,p=p>>>32-12|p<<12,v=v+F|0,M^=v,M=M>>>32-16|M<<16,J=J+M|0,F^=J,F=F>>>32-12|F<<12,w=w+z|0,L^=w,L=L>>>32-16|L<<16,A=A+L|0,z^=A,z=z>>>32-12|z<<12,v=v+F|0,M^=v,M=M>>>32-8|M<<8,J=J+M|0,F^=J,F=F>>>32-7|F<<7,w=w+z|0,L^=w,L=L>>>32-8|L<<8,A=A+L|0,z^=A,z=z>>>32-7|z<<7,g=g+p|0,W^=g,W=W>>>32-8|W<<8,X=X+W|0,p^=X,p=p>>>32-7|p<<7,x=x+o|0,N^=x,N=N>>>32-8|N<<8,k=k+N|0,o^=k,o=o>>>32-7|o<<7,x=x+p|0,L^=x,L=L>>>32-16|L<<16,J=J+L|0,p^=J,p=p>>>32-12|p<<12,g=g+F|0,N^=g,N=N>>>32-16|N<<16,A=A+N|0,F^=A,F=F>>>32-12|F<<12,v=v+z|0,W^=v,W=W>>>32-16|W<<16,k=k+W|0,z^=k,z=z>>>32-12|z<<12,w=w+o|0,M^=w,M=M>>>32-16|M<<16,X=X+M|0,o^=X,o=o>>>32-12|o<<12,v=v+z|0,W^=v,W=W>>>32-8|W<<8,k=k+W|0,z^=k,z=z>>>32-7|z<<7,w=w+o|0,M^=w,M=M>>>32-8|M<<8,X=X+M|0,o^=X,o=o>>>32-7|o<<7,g=g+F|0,N^=g,N=N>>>32-8|N<<8,A=A+N|0,F^=A,F=F>>>32-7|F<<7,x=x+p|0,L^=x,L=L>>>32-8|L<<8,J=J+L|0,p^=J,p=p>>>32-7|p<<7;it.writeUint32LE(x+n|0,t,0),it.writeUint32LE(g+i|0,t,4),it.writeUint32LE(v+s|0,t,8),it.writeUint32LE(w+a|0,t,12),it.writeUint32LE(o+c|0,t,16),it.writeUint32LE(p+h|0,t,20),it.writeUint32LE(F+f|0,t,24),it.writeUint32LE(z+l|0,t,28),it.writeUint32LE(k+m|0,t,32),it.writeUint32LE(X+b|0,t,36),it.writeUint32LE(J+y|0,t,40),it.writeUint32LE(A+S|0,t,44),it.writeUint32LE(N+P|0,t,48),it.writeUint32LE(W+R|0,t,52),it.writeUint32LE(M+j|0,t,56),it.writeUint32LE(L+E|0,t,60)}function uo(t,e,r,n,i){if(i===void 0&&(i=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,a;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),a=s.length-e.length,s.set(e,a)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,a=i}for(var c=new Uint8Array(64),h=0;h<r.length;h+=64){Ul(c,s,t);for(var f=h;f<h+64&&f<r.length;f++)n[f]=r[f]^c[f-h];Ml(s,0,a)}return ni.wipe(c),i===0&&ni.wipe(s),n}nn.streamXOR=uo;function $l(t,e,r,n){return n===void 0&&(n=0),ni.wipe(r),uo(t,e,r,r,n)}nn.stream=$l;function Ml(t,e,r){for(var n=1;r--;)n=n+(t[e]&255)|0,t[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}var fo={},Ft={};Object.defineProperty(Ft,"__esModule",{value:!0});function jl(t,e,r){return~(t-1)&e|t-1&r}Ft.select=jl;function zl(t,e){return(t|0)-(e|0)-1>>>31&1}Ft.lessOrEqual=zl;function ho(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}Ft.compare=ho;function Bl(t,e){return t.length===0||e.length===0?!1:ho(t,e)!==0}Ft.equal=Bl,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Ft,r=pt;t.DIGEST_LENGTH=16;var n=function(){function a(c){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=c[0]|c[1]<<8;this._r[0]=h&8191;var f=c[2]|c[3]<<8;this._r[1]=(h>>>13|f<<3)&8191;var l=c[4]|c[5]<<8;this._r[2]=(f>>>10|l<<6)&7939;var m=c[6]|c[7]<<8;this._r[3]=(l>>>7|m<<9)&8191;var b=c[8]|c[9]<<8;this._r[4]=(m>>>4|b<<12)&255,this._r[5]=b>>>1&8190;var y=c[10]|c[11]<<8;this._r[6]=(b>>>14|y<<2)&8191;var S=c[12]|c[13]<<8;this._r[7]=(y>>>11|S<<5)&8065;var P=c[14]|c[15]<<8;this._r[8]=(S>>>8|P<<8)&8191,this._r[9]=P>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return a.prototype._blocks=function(c,h,f){for(var l=this._fin?0:2048,m=this._h[0],b=this._h[1],y=this._h[2],S=this._h[3],P=this._h[4],R=this._h[5],j=this._h[6],E=this._h[7],x=this._h[8],g=this._h[9],v=this._r[0],w=this._r[1],o=this._r[2],p=this._r[3],F=this._r[4],z=this._r[5],k=this._r[6],X=this._r[7],J=this._r[8],A=this._r[9];f>=16;){var N=c[h+0]|c[h+1]<<8;m+=N&8191;var W=c[h+2]|c[h+3]<<8;b+=(N>>>13|W<<3)&8191;var M=c[h+4]|c[h+5]<<8;y+=(W>>>10|M<<6)&8191;var L=c[h+6]|c[h+7]<<8;S+=(M>>>7|L<<9)&8191;var U=c[h+8]|c[h+9]<<8;P+=(L>>>4|U<<12)&8191,R+=U>>>1&8191;var $=c[h+10]|c[h+11]<<8;j+=(U>>>14|$<<2)&8191;var B=c[h+12]|c[h+13]<<8;E+=($>>>11|B<<5)&8191;var ne=c[h+14]|c[h+15]<<8;x+=(B>>>8|ne<<8)&8191,g+=ne>>>5|l;var q=0,Q=q;Q+=m*v,Q+=b*(5*A),Q+=y*(5*J),Q+=S*(5*X),Q+=P*(5*k),q=Q>>>13,Q&=8191,Q+=R*(5*z),Q+=j*(5*F),Q+=E*(5*p),Q+=x*(5*o),Q+=g*(5*w),q+=Q>>>13,Q&=8191;var Y=q;Y+=m*w,Y+=b*v,Y+=y*(5*A),Y+=S*(5*J),Y+=P*(5*X),q=Y>>>13,Y&=8191,Y+=R*(5*k),Y+=j*(5*z),Y+=E*(5*F),Y+=x*(5*p),Y+=g*(5*o),q+=Y>>>13,Y&=8191;var ae=q;ae+=m*o,ae+=b*w,ae+=y*v,ae+=S*(5*A),ae+=P*(5*J),q=ae>>>13,ae&=8191,ae+=R*(5*X),ae+=j*(5*k),ae+=E*(5*z),ae+=x*(5*F),ae+=g*(5*p),q+=ae>>>13,ae&=8191;var T=q;T+=m*p,T+=b*o,T+=y*w,T+=S*v,T+=P*(5*A),q=T>>>13,T&=8191,T+=R*(5*J),T+=j*(5*X),T+=E*(5*k),T+=x*(5*z),T+=g*(5*F),q+=T>>>13,T&=8191;var I=q;I+=m*F,I+=b*p,I+=y*o,I+=S*w,I+=P*v,q=I>>>13,I&=8191,I+=R*(5*A),I+=j*(5*J),I+=E*(5*X),I+=x*(5*k),I+=g*(5*z),q+=I>>>13,I&=8191;var D=q;D+=m*z,D+=b*F,D+=y*p,D+=S*o,D+=P*w,q=D>>>13,D&=8191,D+=R*v,D+=j*(5*A),D+=E*(5*J),D+=x*(5*X),D+=g*(5*k),q+=D>>>13,D&=8191;var u=q;u+=m*k,u+=b*z,u+=y*F,u+=S*p,u+=P*o,q=u>>>13,u&=8191,u+=R*w,u+=j*v,u+=E*(5*A),u+=x*(5*J),u+=g*(5*X),q+=u>>>13,u&=8191;var _=q;_+=m*X,_+=b*k,_+=y*z,_+=S*F,_+=P*p,q=_>>>13,_&=8191,_+=R*o,_+=j*w,_+=E*v,_+=x*(5*A),_+=g*(5*J),q+=_>>>13,_&=8191;var K=q;K+=m*J,K+=b*X,K+=y*k,K+=S*z,K+=P*F,q=K>>>13,K&=8191,K+=R*p,K+=j*o,K+=E*w,K+=x*v,K+=g*(5*A),q+=K>>>13,K&=8191;var V=q;V+=m*A,V+=b*J,V+=y*X,V+=S*k,V+=P*z,q=V>>>13,V&=8191,V+=R*F,V+=j*p,V+=E*o,V+=x*w,V+=g*v,q+=V>>>13,V&=8191,q=(q<<2)+q|0,q=q+Q|0,Q=q&8191,q=q>>>13,Y+=q,m=Q,b=Y,y=ae,S=T,P=I,R=D,j=u,E=_,x=K,g=V,h+=16,f-=16}this._h[0]=m,this._h[1]=b,this._h[2]=y,this._h[3]=S,this._h[4]=P,this._h[5]=R,this._h[6]=j,this._h[7]=E,this._h[8]=x,this._h[9]=g},a.prototype.finish=function(c,h){h===void 0&&(h=0);var f=new Uint16Array(10),l,m,b,y;if(this._leftover){for(y=this._leftover,this._buffer[y++]=1;y<16;y++)this._buffer[y]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(l=this._h[1]>>>13,this._h[1]&=8191,y=2;y<10;y++)this._h[y]+=l,l=this._h[y]>>>13,this._h[y]&=8191;for(this._h[0]+=l*5,l=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=l,l=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=l,f[0]=this._h[0]+5,l=f[0]>>>13,f[0]&=8191,y=1;y<10;y++)f[y]=this._h[y]+l,l=f[y]>>>13,f[y]&=8191;for(f[9]-=1<<13,m=(l^1)-1,y=0;y<10;y++)f[y]&=m;for(m=~m,y=0;y<10;y++)this._h[y]=this._h[y]&m|f[y];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,b=this._h[0]+this._pad[0],this._h[0]=b&65535,y=1;y<8;y++)b=(this._h[y]+this._pad[y]|0)+(b>>>16)|0,this._h[y]=b&65535;return c[h+0]=this._h[0]>>>0,c[h+1]=this._h[0]>>>8,c[h+2]=this._h[1]>>>0,c[h+3]=this._h[1]>>>8,c[h+4]=this._h[2]>>>0,c[h+5]=this._h[2]>>>8,c[h+6]=this._h[3]>>>0,c[h+7]=this._h[3]>>>8,c[h+8]=this._h[4]>>>0,c[h+9]=this._h[4]>>>8,c[h+10]=this._h[5]>>>0,c[h+11]=this._h[5]>>>8,c[h+12]=this._h[6]>>>0,c[h+13]=this._h[6]>>>8,c[h+14]=this._h[7]>>>0,c[h+15]=this._h[7]>>>8,this._finished=!0,this},a.prototype.update=function(c){var h=0,f=c.length,l;if(this._leftover){l=16-this._leftover,l>f&&(l=f);for(var m=0;m<l;m++)this._buffer[this._leftover+m]=c[h+m];if(f-=l,h+=l,this._leftover+=l,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(f>=16&&(l=f-f%16,this._blocks(c,h,l),h+=l,f-=l),f){for(var m=0;m<f;m++)this._buffer[this._leftover+m]=c[h+m];this._leftover+=f}return this},a.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},a.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},a}();t.Poly1305=n;function i(a,c){var h=new n(a);h.update(c);var f=h.digest();return h.clean(),f}t.oneTimeAuth=i;function s(a,c){return a.length!==t.DIGEST_LENGTH||c.length!==t.DIGEST_LENGTH?!1:e.equal(a,c)}t.equal=s}(fo),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=nn,r=fo,n=pt,i=te,s=Ft;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var a=new Uint8Array(16),c=function(){function h(f){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,f.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(f)}return h.prototype.seal=function(f,l,m,b){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var y=new Uint8Array(16);y.set(f,y.length-f.length);var S=new Uint8Array(32);e.stream(this._key,y,S,4);var P=l.length+this.tagLength,R;if(b){if(b.length!==P)throw new Error("ChaCha20Poly1305: incorrect destination length");R=b}else R=new Uint8Array(P);return e.streamXOR(this._key,y,l,R,4),this._authenticate(R.subarray(R.length-this.tagLength,R.length),S,R.subarray(0,R.length-this.tagLength),m),n.wipe(y),R},h.prototype.open=function(f,l,m,b){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(l.length<this.tagLength)return null;var y=new Uint8Array(16);y.set(f,y.length-f.length);var S=new Uint8Array(32);e.stream(this._key,y,S,4);var P=new Uint8Array(this.tagLength);if(this._authenticate(P,S,l.subarray(0,l.length-this.tagLength),m),!s.equal(P,l.subarray(l.length-this.tagLength,l.length)))return null;var R=l.length-this.tagLength,j;if(b){if(b.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");j=b}else j=new Uint8Array(R);return e.streamXOR(this._key,y,l.subarray(0,l.length-this.tagLength),j,4),n.wipe(y),j},h.prototype.clean=function(){return n.wipe(this._key),this},h.prototype._authenticate=function(f,l,m,b){var y=new r.Poly1305(l);b&&(y.update(b),b.length%16>0&&y.update(a.subarray(b.length%16))),y.update(m),m.length%16>0&&y.update(a.subarray(m.length%16));var S=new Uint8Array(8);b&&i.writeUint64LE(b.length,S),y.update(S),i.writeUint64LE(m.length,S),y.update(S);for(var P=y.digest(),R=0;R<P.length;R++)f[R]=P[R];y.clean(),n.wipe(P),n.wipe(S)},h}();t.ChaCha20Poly1305=c}(ri);var lo={},Ir={},ii={};Object.defineProperty(ii,"__esModule",{value:!0});function ql(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}ii.isSerializableHash=ql,Object.defineProperty(Ir,"__esModule",{value:!0});var Ot=ii,Kl=Ft,Hl=pt,po=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),Ot.isSerializableHash(this._inner)&&Ot.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Hl.wipe(n)}return t.prototype.reset=function(){if(!Ot.isSerializableHash(this._inner)||!Ot.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Ot.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Ot.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Ot.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Ot.isSerializableHash(this._inner)||!Ot.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Ot.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Ir.HMAC=po;function Vl(t,e,r){var n=new po(t,e);n.update(r);var i=n.digest();return n.clean(),i}Ir.hmac=Vl,Ir.equal=Kl.equal,Object.defineProperty(lo,"__esModule",{value:!0});var go=Ir,_o=pt,Gl=function(){function t(e,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var s=go.hmac(this._hash,n,r);this._hmac=new go.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),_o.wipe(this._buffer),_o.wipe(this._counter),this._bufpos=0},t}(),Wl=lo.HKDF=Gl,sn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=te,r=pt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var n=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},c.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var l=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&f>0;)this._buffer[this._bufferLength++]=h[l++],f--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(l=s(this._temp,this._state,h,l,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[l++],f--;return this},c.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,l=this._bufferLength,m=f/536870912|0,b=f<<3,y=f%64<56?64:128;this._buffer[l]=128;for(var S=l+1;S<y-8;S++)this._buffer[S]=0;e.writeUint32BE(m,this._buffer,y-8),e.writeUint32BE(b,this._buffer,y-4),s(this._temp,this._state,this._buffer,0,y),this._finished=!0}for(var S=0;S<this.digestLength/4;S++)e.writeUint32BE(this._state[S],h,S*4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();t.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(c,h,f,l,m){for(;m>=64;){for(var b=h[0],y=h[1],S=h[2],P=h[3],R=h[4],j=h[5],E=h[6],x=h[7],g=0;g<16;g++){var v=l+g*4;c[g]=e.readUint32BE(f,v)}for(var g=16;g<64;g++){var w=c[g-2],o=(w>>>17|w<<32-17)^(w>>>19|w<<32-19)^w>>>10;w=c[g-15];var p=(w>>>7|w<<32-7)^(w>>>18|w<<32-18)^w>>>3;c[g]=(o+c[g-7]|0)+(p+c[g-16]|0)}for(var g=0;g<64;g++){var o=(((R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7))+(R&j^~R&E)|0)+(x+(i[g]+c[g]|0)|0)|0,p=((b>>>2|b<<32-2)^(b>>>13|b<<32-13)^(b>>>22|b<<32-22))+(b&y^b&S^y&S)|0;x=E,E=j,j=R,R=P+o|0,P=S,S=y,y=b,b=o+p|0}h[0]+=b,h[1]+=y,h[2]+=S,h[3]+=P,h[4]+=R,h[5]+=j,h[6]+=E,h[7]+=x,l+=64,m-=64}return l}function a(c){var h=new n;h.update(c);var f=h.digest();return h.clean(),f}t.hash=a})(sn);var si={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=ar,r=pt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function n(g){const v=new Float64Array(16);if(g)for(let w=0;w<g.length;w++)v[w]=g[w];return v}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function a(g){let v=1;for(let w=0;w<16;w++){let o=g[w]+v+65535;v=Math.floor(o/65536),g[w]=o-v*65536}g[0]+=v-1+37*(v-1)}function c(g,v,w){const o=~(w-1);for(let p=0;p<16;p++){const F=o&(g[p]^v[p]);g[p]^=F,v[p]^=F}}function h(g,v){const w=n(),o=n();for(let p=0;p<16;p++)o[p]=v[p];a(o),a(o),a(o);for(let p=0;p<2;p++){w[0]=o[0]-65517;for(let z=1;z<15;z++)w[z]=o[z]-65535-(w[z-1]>>16&1),w[z-1]&=65535;w[15]=o[15]-32767-(w[14]>>16&1);const F=w[15]>>16&1;w[14]&=65535,c(o,w,1-F)}for(let p=0;p<16;p++)g[2*p]=o[p]&255,g[2*p+1]=o[p]>>8}function f(g,v){for(let w=0;w<16;w++)g[w]=v[2*w]+(v[2*w+1]<<8);g[15]&=32767}function l(g,v,w){for(let o=0;o<16;o++)g[o]=v[o]+w[o]}function m(g,v,w){for(let o=0;o<16;o++)g[o]=v[o]-w[o]}function b(g,v,w){let o,p,F=0,z=0,k=0,X=0,J=0,A=0,N=0,W=0,M=0,L=0,U=0,$=0,B=0,ne=0,q=0,Q=0,Y=0,ae=0,T=0,I=0,D=0,u=0,_=0,K=0,V=0,he=0,ye=0,de=0,ve=0,Ue=0,Pe=0,_e=w[0],pe=w[1],le=w[2],ue=w[3],ce=w[4],oe=w[5],se=w[6],ee=w[7],fe=w[8],ge=w[9],re=w[10],be=w[11],we=w[12],Ee=w[13],Se=w[14],me=w[15];o=v[0],F+=o*_e,z+=o*pe,k+=o*le,X+=o*ue,J+=o*ce,A+=o*oe,N+=o*se,W+=o*ee,M+=o*fe,L+=o*ge,U+=o*re,$+=o*be,B+=o*we,ne+=o*Ee,q+=o*Se,Q+=o*me,o=v[1],z+=o*_e,k+=o*pe,X+=o*le,J+=o*ue,A+=o*ce,N+=o*oe,W+=o*se,M+=o*ee,L+=o*fe,U+=o*ge,$+=o*re,B+=o*be,ne+=o*we,q+=o*Ee,Q+=o*Se,Y+=o*me,o=v[2],k+=o*_e,X+=o*pe,J+=o*le,A+=o*ue,N+=o*ce,W+=o*oe,M+=o*se,L+=o*ee,U+=o*fe,$+=o*ge,B+=o*re,ne+=o*be,q+=o*we,Q+=o*Ee,Y+=o*Se,ae+=o*me,o=v[3],X+=o*_e,J+=o*pe,A+=o*le,N+=o*ue,W+=o*ce,M+=o*oe,L+=o*se,U+=o*ee,$+=o*fe,B+=o*ge,ne+=o*re,q+=o*be,Q+=o*we,Y+=o*Ee,ae+=o*Se,T+=o*me,o=v[4],J+=o*_e,A+=o*pe,N+=o*le,W+=o*ue,M+=o*ce,L+=o*oe,U+=o*se,$+=o*ee,B+=o*fe,ne+=o*ge,q+=o*re,Q+=o*be,Y+=o*we,ae+=o*Ee,T+=o*Se,I+=o*me,o=v[5],A+=o*_e,N+=o*pe,W+=o*le,M+=o*ue,L+=o*ce,U+=o*oe,$+=o*se,B+=o*ee,ne+=o*fe,q+=o*ge,Q+=o*re,Y+=o*be,ae+=o*we,T+=o*Ee,I+=o*Se,D+=o*me,o=v[6],N+=o*_e,W+=o*pe,M+=o*le,L+=o*ue,U+=o*ce,$+=o*oe,B+=o*se,ne+=o*ee,q+=o*fe,Q+=o*ge,Y+=o*re,ae+=o*be,T+=o*we,I+=o*Ee,D+=o*Se,u+=o*me,o=v[7],W+=o*_e,M+=o*pe,L+=o*le,U+=o*ue,$+=o*ce,B+=o*oe,ne+=o*se,q+=o*ee,Q+=o*fe,Y+=o*ge,ae+=o*re,T+=o*be,I+=o*we,D+=o*Ee,u+=o*Se,_+=o*me,o=v[8],M+=o*_e,L+=o*pe,U+=o*le,$+=o*ue,B+=o*ce,ne+=o*oe,q+=o*se,Q+=o*ee,Y+=o*fe,ae+=o*ge,T+=o*re,I+=o*be,D+=o*we,u+=o*Ee,_+=o*Se,K+=o*me,o=v[9],L+=o*_e,U+=o*pe,$+=o*le,B+=o*ue,ne+=o*ce,q+=o*oe,Q+=o*se,Y+=o*ee,ae+=o*fe,T+=o*ge,I+=o*re,D+=o*be,u+=o*we,_+=o*Ee,K+=o*Se,V+=o*me,o=v[10],U+=o*_e,$+=o*pe,B+=o*le,ne+=o*ue,q+=o*ce,Q+=o*oe,Y+=o*se,ae+=o*ee,T+=o*fe,I+=o*ge,D+=o*re,u+=o*be,_+=o*we,K+=o*Ee,V+=o*Se,he+=o*me,o=v[11],$+=o*_e,B+=o*pe,ne+=o*le,q+=o*ue,Q+=o*ce,Y+=o*oe,ae+=o*se,T+=o*ee,I+=o*fe,D+=o*ge,u+=o*re,_+=o*be,K+=o*we,V+=o*Ee,he+=o*Se,ye+=o*me,o=v[12],B+=o*_e,ne+=o*pe,q+=o*le,Q+=o*ue,Y+=o*ce,ae+=o*oe,T+=o*se,I+=o*ee,D+=o*fe,u+=o*ge,_+=o*re,K+=o*be,V+=o*we,he+=o*Ee,ye+=o*Se,de+=o*me,o=v[13],ne+=o*_e,q+=o*pe,Q+=o*le,Y+=o*ue,ae+=o*ce,T+=o*oe,I+=o*se,D+=o*ee,u+=o*fe,_+=o*ge,K+=o*re,V+=o*be,he+=o*we,ye+=o*Ee,de+=o*Se,ve+=o*me,o=v[14],q+=o*_e,Q+=o*pe,Y+=o*le,ae+=o*ue,T+=o*ce,I+=o*oe,D+=o*se,u+=o*ee,_+=o*fe,K+=o*ge,V+=o*re,he+=o*be,ye+=o*we,de+=o*Ee,ve+=o*Se,Ue+=o*me,o=v[15],Q+=o*_e,Y+=o*pe,ae+=o*le,T+=o*ue,I+=o*ce,D+=o*oe,u+=o*se,_+=o*ee,K+=o*fe,V+=o*ge,he+=o*re,ye+=o*be,de+=o*we,ve+=o*Ee,Ue+=o*Se,Pe+=o*me,F+=38*Y,z+=38*ae,k+=38*T,X+=38*I,J+=38*D,A+=38*u,N+=38*_,W+=38*K,M+=38*V,L+=38*he,U+=38*ye,$+=38*de,B+=38*ve,ne+=38*Ue,q+=38*Pe,p=1,o=F+p+65535,p=Math.floor(o/65536),F=o-p*65536,o=z+p+65535,p=Math.floor(o/65536),z=o-p*65536,o=k+p+65535,p=Math.floor(o/65536),k=o-p*65536,o=X+p+65535,p=Math.floor(o/65536),X=o-p*65536,o=J+p+65535,p=Math.floor(o/65536),J=o-p*65536,o=A+p+65535,p=Math.floor(o/65536),A=o-p*65536,o=N+p+65535,p=Math.floor(o/65536),N=o-p*65536,o=W+p+65535,p=Math.floor(o/65536),W=o-p*65536,o=M+p+65535,p=Math.floor(o/65536),M=o-p*65536,o=L+p+65535,p=Math.floor(o/65536),L=o-p*65536,o=U+p+65535,p=Math.floor(o/65536),U=o-p*65536,o=$+p+65535,p=Math.floor(o/65536),$=o-p*65536,o=B+p+65535,p=Math.floor(o/65536),B=o-p*65536,o=ne+p+65535,p=Math.floor(o/65536),ne=o-p*65536,o=q+p+65535,p=Math.floor(o/65536),q=o-p*65536,o=Q+p+65535,p=Math.floor(o/65536),Q=o-p*65536,F+=p-1+37*(p-1),p=1,o=F+p+65535,p=Math.floor(o/65536),F=o-p*65536,o=z+p+65535,p=Math.floor(o/65536),z=o-p*65536,o=k+p+65535,p=Math.floor(o/65536),k=o-p*65536,o=X+p+65535,p=Math.floor(o/65536),X=o-p*65536,o=J+p+65535,p=Math.floor(o/65536),J=o-p*65536,o=A+p+65535,p=Math.floor(o/65536),A=o-p*65536,o=N+p+65535,p=Math.floor(o/65536),N=o-p*65536,o=W+p+65535,p=Math.floor(o/65536),W=o-p*65536,o=M+p+65535,p=Math.floor(o/65536),M=o-p*65536,o=L+p+65535,p=Math.floor(o/65536),L=o-p*65536,o=U+p+65535,p=Math.floor(o/65536),U=o-p*65536,o=$+p+65535,p=Math.floor(o/65536),$=o-p*65536,o=B+p+65535,p=Math.floor(o/65536),B=o-p*65536,o=ne+p+65535,p=Math.floor(o/65536),ne=o-p*65536,o=q+p+65535,p=Math.floor(o/65536),q=o-p*65536,o=Q+p+65535,p=Math.floor(o/65536),Q=o-p*65536,F+=p-1+37*(p-1),g[0]=F,g[1]=z,g[2]=k,g[3]=X,g[4]=J,g[5]=A,g[6]=N,g[7]=W,g[8]=M,g[9]=L,g[10]=U,g[11]=$,g[12]=B,g[13]=ne,g[14]=q,g[15]=Q}function y(g,v){b(g,v,v)}function S(g,v){const w=n();for(let o=0;o<16;o++)w[o]=v[o];for(let o=253;o>=0;o--)y(w,w),o!==2&&o!==4&&b(w,w,v);for(let o=0;o<16;o++)g[o]=w[o]}function P(g,v){const w=new Uint8Array(32),o=new Float64Array(80),p=n(),F=n(),z=n(),k=n(),X=n(),J=n();for(let M=0;M<31;M++)w[M]=g[M];w[31]=g[31]&127|64,w[0]&=248,f(o,v);for(let M=0;M<16;M++)F[M]=o[M];p[0]=k[0]=1;for(let M=254;M>=0;--M){const L=w[M>>>3]>>>(M&7)&1;c(p,F,L),c(z,k,L),l(X,p,z),m(p,p,z),l(z,F,k),m(F,F,k),y(k,X),y(J,p),b(p,z,p),b(z,F,X),l(X,p,z),m(p,p,z),y(F,p),m(z,k,J),b(p,z,s),l(p,p,k),b(z,z,p),b(p,k,J),b(k,F,o),y(F,X),c(p,F,L),c(z,k,L)}for(let M=0;M<16;M++)o[M+16]=p[M],o[M+32]=z[M],o[M+48]=F[M],o[M+64]=k[M];const A=o.subarray(32),N=o.subarray(16);S(A,A),b(N,N,A);const W=new Uint8Array(32);return h(W,N),W}t.scalarMult=P;function R(g){return P(g,i)}t.scalarMultBase=R;function j(g){if(g.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const v=new Uint8Array(g);return{publicKey:R(v),secretKey:v}}t.generateKeyPairFromSeed=j;function E(g){const v=(0,e.randomBytes)(32,g),w=j(v);return(0,r.wipe)(v),w}t.generateKeyPair=E;function x(g,v,w=!1){if(g.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(v.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=P(g,v);if(w){let p=0;for(let F=0;F<o.length;F++)p|=o[F];if(p===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=x})(si);var yo=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},Yl=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),kl=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Xl=function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t}(),Jl=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Zl=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Ql=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,ed=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,bo=3,td=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Ql]],wo=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function rd(t){return t?vo(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Zl:typeof navigator<"u"?vo(navigator.userAgent):sd()}function nd(t){return t!==""&&td.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var s=i.exec(t);return!!s&&[n,s]},!1)}function vo(t){var e=nd(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new Jl;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<bo&&(i=yo(yo([],i,!0),od(bo-i.length),!0)):i=[];var s=i.join("."),a=id(t),c=ed.exec(t);return c&&c[1]?new Xl(r,s,a,c[1]):new Yl(r,s,a)}function id(t){for(var e=0,r=wo.length;e<r;e++){var n=wo[e],i=n[0],s=n[1],a=s.exec(t);if(a)return i}return null}function sd(){var t=typeof process<"u"&&process.version;return t?new kl(process.version.slice(1)):null}function od(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.getLocalStorage=Ie.getLocalStorageOrThrow=Ie.getCrypto=Ie.getCryptoOrThrow=Eo=Ie.getLocation=Ie.getLocationOrThrow=oi=Ie.getNavigator=Ie.getNavigatorOrThrow=mo=Ie.getDocument=Ie.getDocumentOrThrow=Ie.getFromWindowOrThrow=Ie.getFromWindow=void 0;function kt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Ie.getFromWindow=kt;function cr(t){const e=kt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Ie.getFromWindowOrThrow=cr;function ad(){return cr("document")}Ie.getDocumentOrThrow=ad;function cd(){return kt("document")}var mo=Ie.getDocument=cd;function ud(){return cr("navigator")}Ie.getNavigatorOrThrow=ud;function fd(){return kt("navigator")}var oi=Ie.getNavigator=fd;function hd(){return cr("location")}Ie.getLocationOrThrow=hd;function ld(){return kt("location")}var Eo=Ie.getLocation=ld;function dd(){return cr("crypto")}Ie.getCryptoOrThrow=dd;function pd(){return kt("crypto")}Ie.getCrypto=pd;function gd(){return cr("localStorage")}Ie.getLocalStorageOrThrow=gd;function _d(){return kt("localStorage")}Ie.getLocalStorage=_d;var ai={};Object.defineProperty(ai,"__esModule",{value:!0});var So=ai.getWindowMetadata=void 0;const Do=Ie;function yd(){let t,e;try{t=Do.getDocumentOrThrow(),e=Do.getLocationOrThrow()}catch{return null}function r(){const m=t.getElementsByTagName("link"),b=[];for(let y=0;y<m.length;y++){const S=m[y],P=S.getAttribute("rel");if(P&&P.toLowerCase().indexOf("icon")>-1){const R=S.getAttribute("href");if(R)if(R.toLowerCase().indexOf("https:")===-1&&R.toLowerCase().indexOf("http:")===-1&&R.indexOf("//")!==0){let j=e.protocol+"//"+e.host;if(R.indexOf("/")===0)j+=R;else{const E=e.pathname.split("/");E.pop();const x=E.join("/");j+=x+"/"+R}b.push(j)}else if(R.indexOf("//")===0){const j=e.protocol+R;b.push(j)}else b.push(R)}}return b}function n(...m){const b=t.getElementsByTagName("meta");for(let y=0;y<b.length;y++){const S=b[y],P=["itemprop","property","name"].map(R=>S.getAttribute(R)).filter(R=>R?m.includes(R):!1);if(P.length&&P){const R=S.getAttribute("content");if(R)return R}}return""}function i(){let m=n("name","og:site_name","og:title","twitter:title");return m||(m=t.title),m}function s(){return n("description","og:description","twitter:description","keywords")}const a=i(),c=s(),h=e.origin,f=r();return{description:c,url:h,icons:f,name:a}}So=ai.getWindowMetadata=yd;var Tr={},bd=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Oo="%[a-f0-9]{2}",xo=new RegExp("("+Oo+")|([^%]+?)","gi"),Io=new RegExp("("+Oo+")+","gi");function ci(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],ci(r),ci(n))}function wd(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(xo)||[],r=1;r<e.length;r++)t=ci(e,r).join(""),e=t.match(xo)||[];return t}}function vd(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=Io.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var n=wd(r[0]);n!==r[0]&&(e[r[0]]=n)}r=Io.exec(t)}e["%C2"]="\uFFFD";for(var i=Object.keys(e),s=0;s<i.length;s++){var a=i[s];t=t.replace(new RegExp(a,"g"),e[a])}return t}var md=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return vd(t)}},Ed=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},Sd=function(t,e){for(var r={},n=Object.keys(t),i=Array.isArray(e),s=0;s<n.length;s++){var a=n[s],c=t[a];(i?e.indexOf(a)!==-1:e(a,c,t))&&(r[a]=c)}return r};(function(t){const e=bd,r=md,n=Ed,i=Sd,s=E=>E==null,a=Symbol("encodeFragmentIdentifier");function c(E){switch(E.arrayFormat){case"index":return x=>(g,v)=>{const w=g.length;return v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?g:v===null?[...g,[l(x,E),"[",w,"]"].join("")]:[...g,[l(x,E),"[",l(w,E),"]=",l(v,E)].join("")]};case"bracket":return x=>(g,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?g:v===null?[...g,[l(x,E),"[]"].join("")]:[...g,[l(x,E),"[]=",l(v,E)].join("")];case"colon-list-separator":return x=>(g,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?g:v===null?[...g,[l(x,E),":list="].join("")]:[...g,[l(x,E),":list=",l(v,E)].join("")];case"comma":case"separator":case"bracket-separator":{const x=E.arrayFormat==="bracket-separator"?"[]=":"=";return g=>(v,w)=>w===void 0||E.skipNull&&w===null||E.skipEmptyString&&w===""?v:(w=w===null?"":w,v.length===0?[[l(g,E),x,l(w,E)].join("")]:[[v,l(w,E)].join(E.arrayFormatSeparator)])}default:return x=>(g,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?g:v===null?[...g,l(x,E)]:[...g,[l(x,E),"=",l(v,E)].join("")]}}function h(E){let x;switch(E.arrayFormat){case"index":return(g,v,w)=>{if(x=/\[(\d*)\]$/.exec(g),g=g.replace(/\[\d*\]$/,""),!x){w[g]=v;return}w[g]===void 0&&(w[g]={}),w[g][x[1]]=v};case"bracket":return(g,v,w)=>{if(x=/(\[\])$/.exec(g),g=g.replace(/\[\]$/,""),!x){w[g]=v;return}if(w[g]===void 0){w[g]=[v];return}w[g]=[].concat(w[g],v)};case"colon-list-separator":return(g,v,w)=>{if(x=/(:list)$/.exec(g),g=g.replace(/:list$/,""),!x){w[g]=v;return}if(w[g]===void 0){w[g]=[v];return}w[g]=[].concat(w[g],v)};case"comma":case"separator":return(g,v,w)=>{const o=typeof v=="string"&&v.includes(E.arrayFormatSeparator),p=typeof v=="string"&&!o&&m(v,E).includes(E.arrayFormatSeparator);v=p?m(v,E):v;const F=o||p?v.split(E.arrayFormatSeparator).map(z=>m(z,E)):v===null?v:m(v,E);w[g]=F};case"bracket-separator":return(g,v,w)=>{const o=/(\[\])$/.test(g);if(g=g.replace(/\[\]$/,""),!o){w[g]=v&&m(v,E);return}const p=v===null?[]:v.split(E.arrayFormatSeparator).map(F=>m(F,E));if(w[g]===void 0){w[g]=p;return}w[g]=[].concat(w[g],p)};default:return(g,v,w)=>{if(w[g]===void 0){w[g]=v;return}w[g]=[].concat(w[g],v)}}}function f(E){if(typeof E!="string"||E.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function l(E,x){return x.encode?x.strict?e(E):encodeURIComponent(E):E}function m(E,x){return x.decode?r(E):E}function b(E){return Array.isArray(E)?E.sort():typeof E=="object"?b(Object.keys(E)).sort((x,g)=>Number(x)-Number(g)).map(x=>E[x]):E}function y(E){const x=E.indexOf("#");return x!==-1&&(E=E.slice(0,x)),E}function S(E){let x="";const g=E.indexOf("#");return g!==-1&&(x=E.slice(g)),x}function P(E){E=y(E);const x=E.indexOf("?");return x===-1?"":E.slice(x+1)}function R(E,x){return x.parseNumbers&&!Number.isNaN(Number(E))&&typeof E=="string"&&E.trim()!==""?E=Number(E):x.parseBooleans&&E!==null&&(E.toLowerCase()==="true"||E.toLowerCase()==="false")&&(E=E.toLowerCase()==="true"),E}function j(E,x){x=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},x),f(x.arrayFormatSeparator);const g=h(x),v=Object.create(null);if(typeof E!="string"||(E=E.trim().replace(/^[?#&]/,""),!E))return v;for(const w of E.split("&")){if(w==="")continue;let[o,p]=n(x.decode?w.replace(/\+/g," "):w,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(x.arrayFormat)?p:m(p,x),g(m(o,x),p,v)}for(const w of Object.keys(v)){const o=v[w];if(typeof o=="object"&&o!==null)for(const p of Object.keys(o))o[p]=R(o[p],x);else v[w]=R(o,x)}return x.sort===!1?v:(x.sort===!0?Object.keys(v).sort():Object.keys(v).sort(x.sort)).reduce((w,o)=>{const p=v[o];return Boolean(p)&&typeof p=="object"&&!Array.isArray(p)?w[o]=b(p):w[o]=p,w},Object.create(null))}t.extract=P,t.parse=j,t.stringify=(E,x)=>{if(!E)return"";x=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},x),f(x.arrayFormatSeparator);const g=p=>x.skipNull&&s(E[p])||x.skipEmptyString&&E[p]==="",v=c(x),w={};for(const p of Object.keys(E))g(p)||(w[p]=E[p]);const o=Object.keys(w);return x.sort!==!1&&o.sort(x.sort),o.map(p=>{const F=E[p];return F===void 0?"":F===null?l(p,x):Array.isArray(F)?F.length===0&&x.arrayFormat==="bracket-separator"?l(p,x)+"[]":F.reduce(v(p),[]).join("&"):l(p,x)+"="+l(F,x)}).filter(p=>p.length>0).join("&")},t.parseUrl=(E,x)=>{x=Object.assign({decode:!0},x);const[g,v]=n(E,"#");return Object.assign({url:g.split("?")[0]||"",query:j(P(E),x)},x&&x.parseFragmentIdentifier&&v?{fragmentIdentifier:m(v,x)}:{})},t.stringifyUrl=(E,x)=>{x=Object.assign({encode:!0,strict:!0,[a]:!0},x);const g=y(E.url).split("?")[0]||"",v=t.extract(E.url),w=t.parse(v,{sort:!1}),o=Object.assign(w,E.query);let p=t.stringify(o,x);p&&(p=`?${p}`);let F=S(E.url);return E.fragmentIdentifier&&(F=`#${x[a]?l(E.fragmentIdentifier,x):E.fragmentIdentifier}`),`${g}${p}${F}`},t.pick=(E,x,g)=>{g=Object.assign({parseFragmentIdentifier:!0,[a]:!1},g);const{url:v,query:w,fragmentIdentifier:o}=t.parseUrl(E,g);return t.stringifyUrl({url:v,query:i(w,x),fragmentIdentifier:o},g)},t.exclude=(E,x,g)=>{const v=Array.isArray(x)?w=>!x.includes(w):(w,o)=>!x(w,o);return t.pick(E,v,g)}})(Tr);const Dd={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function ui(t,e){return t.includes(":")?[t]:e.chains||[]}const To="base10",lt="base16",fi="base64pad",hi="utf8",No=0,Xt=1,Od=0,Ao=1,li=12,di=32;function xd(){const t=si.generateKeyPair();return{privateKey:ft(t.secretKey,lt),publicKey:ft(t.publicKey,lt)}}function pi(){const t=ar.randomBytes(di);return ft(t,lt)}function Id(t,e){const r=si.sharedKey(ht(t,lt),ht(e,lt)),n=new Wl(sn.SHA256,r).expand(di);return ft(n,lt)}function Td(t){const e=sn.hash(ht(t,lt));return ft(e,lt)}function on(t){const e=sn.hash(ht(t,hi));return ft(e,lt)}function Nd(t){return ht(`${t}`,To)}function Nr(t){return Number(ft(t,To))}function Ad(t){const e=Nd(typeof t.type<"u"?t.type:No);if(Nr(e)===Xt&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?ht(t.senderPublicKey,lt):void 0,n=typeof t.iv<"u"?ht(t.iv,lt):ar.randomBytes(li),i=new ri.ChaCha20Poly1305(ht(t.symKey,lt)).seal(n,ht(t.message,hi));return Rd({type:e,sealed:i,iv:n,senderPublicKey:r})}function Pd(t){const e=new ri.ChaCha20Poly1305(ht(t.symKey,lt)),{sealed:r,iv:n}=gi(t.encoded),i=e.open(n,r);if(i===null)throw new Error("Failed to decrypt");return ft(i,hi)}function Rd(t){if(Nr(t.type)===Xt){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ft(Zn([t.type,t.senderPublicKey,t.iv,t.sealed]),fi)}return ft(Zn([t.type,t.iv,t.sealed]),fi)}function gi(t){const e=ht(t,fi),r=e.slice(Od,Ao),n=Ao;if(Nr(r)===Xt){const c=n+di,h=c+li,f=e.slice(n,c),l=e.slice(c,h),m=e.slice(h);return{type:r,sealed:m,iv:l,senderPublicKey:f}}const i=n+li,s=e.slice(n,i),a=e.slice(i);return{type:r,sealed:a,iv:s}}function Cd(t,e){const r=gi(t);return Po({type:Nr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ft(r.senderPublicKey,lt):void 0,receiverPublicKey:e?.receiverPublicKey})}function Po(t){const e=t?.type||No;if(e===Xt){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Ro(t){return t.type===Xt&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var Ld=Object.defineProperty,Co=Object.getOwnPropertySymbols,Fd=Object.prototype.hasOwnProperty,Ud=Object.prototype.propertyIsEnumerable,Lo=(t,e,r)=>e in t?Ld(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Fo=(t,e)=>{for(var r in e||(e={}))Fd.call(e,r)&&Lo(t,r,e[r]);if(Co)for(var r of Co(e))Ud.call(e,r)&&Lo(t,r,e[r]);return t};const $d="ReactNative",Ar={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Md="js";function Uo(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function jd(){return!mo()&&!!oi()&&navigator.product===$d}function zd(){return!Uo()&&!!oi()}function Bd(){return jd()?Ar.reactNative:Uo()?Ar.node:zd()?Ar.browser:Ar.unknown}function qd(t,e){let r=Tr.parse(t);return r=Fo(Fo({},r),e),t=Tr.stringify(r),t}function Kd(){return So()||{name:"",description:"",url:"",icons:[""]}}function Hd(){const t=rd();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Vd(){var t;const e=Bd();return e===Ar.browser?[e,((t=Eo())==null?void 0:t.host)||"unknown"].join(":"):e}function Gd(t,e,r){const n=Hd(),i=Vd();return[[t,e].join("-"),[Md,r].join("-"),n,i].join("/")}function Wd({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:s}){const a=r.split("?"),c=Gd(t,e,n),h={auth:i,ua:c,projectId:s},f=qd(a[1]||"",h);return a[0]+"?"+f}function Ut(t,e){return t.filter(r=>e.includes(r)).length===t.length}function $o(t){return Object.fromEntries(t.entries())}function Mo(t){return new Map(Object.entries(t))}function Jt(t=Z.FIVE_MINUTES,e){const r=Z.toMiliseconds(t||Z.FIVE_MINUTES);let n,i,s;return{resolve:a=>{s&&n&&(clearTimeout(s),n(a))},reject:a=>{s&&i&&(clearTimeout(s),i(a))},done:()=>new Promise((a,c)=>{s=setTimeout(()=>{c(new Error(e))},r),n=a,i=c})}}function _i(t,e){return new Promise(async(r,n)=>{const i=setTimeout(()=>n(),e),s=await t;clearTimeout(i),r(s)})}function jo(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Yd(t){return jo("topic",t)}function kd(t){return jo("id",t)}function zo(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function xt(t,e){return Z.fromMiliseconds((e||Date.now())+Z.toMiliseconds(t))}function $t(t){return Date.now()>=Z.toMiliseconds(t)}function Fe(t,e){return`${t}${e?`:${e}`:""}`}const Xd="irn";function yi(t){return t?.relay||{protocol:Xd}}function an(t){const e=Dd[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var Jd=Object.defineProperty,Bo=Object.getOwnPropertySymbols,Zd=Object.prototype.hasOwnProperty,Qd=Object.prototype.propertyIsEnumerable,qo=(t,e,r)=>e in t?Jd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ep=(t,e)=>{for(var r in e||(e={}))Zd.call(e,r)&&qo(t,r,e[r]);if(Bo)for(var r of Bo(e))Qd.call(e,r)&&qo(t,r,e[r]);return t};function tp(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),a=t[i];r[s]=a}}),r}function rp(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",a=Tr.parse(s);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:a.symKey,relay:tp(a)}}function np(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const s=r+e+i;t[i]&&(n[s]=t[i])}),n}function ip(t){return`${t.protocol}:${t.topic}@${t.version}?`+Tr.stringify(ep({symKey:t.symKey},np(t.relay)))}function Pr(t){const e=[];return t.forEach(r=>{const[n,i]=r.split(":");e.push(`${n}:${i}`)}),e}function sp(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Pr(r.accounts))}),e}function op(t,e){const r=[];return Object.values(t).forEach(n=>{Pr(n.accounts).includes(e)&&r.push(...n.methods)}),r}function ap(t,e){const r=[];return Object.values(t).forEach(n=>{Pr(n.accounts).includes(e)&&r.push(...n.events)}),r}function cp(t,e){const r=un(t,e);if(r)throw new Error(r.message);const n={};for(const[i,s]of Object.entries(t))n[i]={methods:s.methods,events:s.events,chains:s.accounts.map(a=>`${a.split(":")[0]}:${a.split(":")[1]}`)};return n}const up={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},fp={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function H(t,e){const{message:r,code:n}=fp[t];return{message:e?`${r} ${e}`:r,code:n}}function Ke(t,e){const{message:r,code:n}=up[t];return{message:e?`${r} ${e}`:r,code:n}}function cn(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Rr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function at(t){return typeof t>"u"}function He(t,e){return e&&at(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function bi(t,e){return e&&at(t)?!0:typeof t=="number"&&!isNaN(t)}function hp(t,e){const{requiredNamespaces:r}=e,n=Object.keys(t.namespaces),i=Object.keys(r);let s=!0;return Ut(i,n)?(n.forEach(a=>{const{accounts:c,methods:h,events:f}=t.namespaces[a],l=Pr(c),m=r[a];(!Ut(ui(a,m),l)||!Ut(m.methods,h)||!Ut(m.events,f))&&(s=!1)}),s):!1}function wi(t){return He(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function lp(t){if(He(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&wi(r)}}return!1}function dp(t){if(He(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function pp(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function gp(t){return t?.topic}function _p(t,e){let r=null;return He(t?.publicKey,!1)||(r=H("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Ko(t){let e=!0;return cn(t)?t.length&&(e=t.every(r=>He(r,!1))):e=!1,e}function yp(t,e,r){let n=null;return cn(e)?e.forEach(i=>{n||(!wi(i)||!i.includes(t))&&(n=Ke("UNSUPPORTED_CHAINS",`${r}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):n=Ke("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),n}function bp(t,e){let r=null;return Object.entries(t).forEach(([n,i])=>{if(r)return;const s=yp(n,ui(n,i),`${e} requiredNamespace`);s&&(r=s)}),r}function wp(t,e){let r=null;return cn(t)?t.forEach(n=>{r||lp(n)||(r=Ke("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=Ke("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function vp(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=wp(n?.accounts,`${e} namespace`);i&&(r=i)}),r}function mp(t,e){let r=null;return Ko(t?.methods)?Ko(t?.events)||(r=Ke("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Ke("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Ho(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=mp(n,`${e}, namespace`);i&&(r=i)}),r}function Ep(t,e,r){let n=null;if(t&&Rr(t)){const i=Ho(t,e);i&&(n=i);const s=bp(t,e);s&&(n=s)}else n=H("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return n}function un(t,e){let r=null;if(t&&Rr(t)){const n=Ho(t,e);n&&(r=n);const i=vp(t,e);i&&(r=i)}else r=H("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Vo(t){return He(t.protocol,!0)}function Sp(t,e){let r=!1;return e&&!t?r=!0:t&&cn(t)&&t.length&&t.forEach(n=>{r=Vo(n)}),r}function Dp(t){return typeof t=="number"}function dt(t){return typeof t<"u"&&typeof t!==null}function Op(t){return!(!t||typeof t!="object"||!t.code||!bi(t.code,!1)||!t.message||!He(t.message,!1))}function xp(t){return!(at(t)||!He(t.method,!1))}function Ip(t){return!(at(t)||at(t.result)&&at(t.error)||!bi(t.id,!1)||!He(t.jsonrpc,!1))}function Tp(t){return!(at(t)||!He(t.name,!1))}function Go(t,e){return!(!wi(e)||!sp(t).includes(e))}function Np(t,e,r){return He(r,!1)?op(t,e).includes(r):!1}function Ap(t,e,r){return He(r,!1)?ap(t,e).includes(r):!1}function vi(t,e,r,n){let i=null;const s=Object.keys(t),a=Object.keys(e);return Ut(s,a)?s.forEach(c=>{if(i)return;const h=Pr(e[c].accounts);Ut(ui(c,t[c]),h)?Ut(t[c].methods,e[c].methods)?Ut(t[c].events,e[c].events)||(i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${c}`)):i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${c}`):i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace chains for ${c}`)}):i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy ${n}`),i}function Pp(t,e){return bi(t,!1)&&t<=e.max&&t>=e.min}const Rp="PARSE_ERROR",Cp="INVALID_REQUEST",Lp="METHOD_NOT_FOUND",Fp="INVALID_PARAMS",Wo="INTERNAL_ERROR",mi="SERVER_ERROR",Up=[-32700,-32600,-32601,-32602,-32603],Cr={[Rp]:{code:-32700,message:"Parse error"},[Cp]:{code:-32600,message:"Invalid Request"},[Lp]:{code:-32601,message:"Method not found"},[Fp]:{code:-32602,message:"Invalid params"},[Wo]:{code:-32603,message:"Internal error"},[mi]:{code:-32e3,message:"Server error"}},Yo=mi;function $p(t){return Up.includes(t)}function ko(t){return Object.keys(Cr).includes(t)?Cr[t]:Cr[Yo]}function Mp(t){const e=Object.values(Cr).find(r=>r.code===t);return e||Cr[Yo]}function jp(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Xo={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Ei=function(t,e){return Ei=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Ei(t,e)};function zp(t,e){Ei(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Si=function(){return Si=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Si.apply(this,arguments)};function Bp(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function qp(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(i<3?a(s):i>3?a(e,r,s):a(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Kp(t,e){return function(r,n){e(r,n,t)}}function Hp(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Vp(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(l){try{f(n.next(l))}catch(m){a(m)}}function h(l){try{f(n.throw(l))}catch(m){a(m)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(t,e||[])).next())})}function Gp(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Wp(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Yp(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Di(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Jo(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function kp(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Jo(arguments[e]));return t}function Xp(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function Lr(t){return this instanceof Lr?(this.v=t,this):new Lr(t)}function Jp(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(y){return new Promise(function(S,P){s.push([b,y,S,P])>1||c(b,y)})})}function c(b,y){try{h(n[b](y))}catch(S){m(s[0][3],S)}}function h(b){b.value instanceof Lr?Promise.resolve(b.value.v).then(f,l):m(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function m(b,y){b(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Zp(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(a){return(r=!r)?{value:Lr(t[i](a)),done:i==="return"}:s?s(a):a}:s}}function Qp(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Di=="function"?Di(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),i(c,h,a.done,a.value)})}}function i(s,a,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},a)}}function eg(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function tg(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function rg(t){return t&&t.__esModule?t:{default:t}}function ng(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function ig(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var sg=Object.freeze({__proto__:null,__extends:zp,get __assign(){return Si},__rest:Bp,__decorate:qp,__param:Kp,__metadata:Hp,__awaiter:Vp,__generator:Gp,__createBinding:Wp,__exportStar:Yp,__values:Di,__read:Jo,__spread:kp,__spreadArrays:Xp,__await:Lr,__asyncGenerator:Jp,__asyncDelegator:Zp,__asyncValues:Qp,__makeTemplateObject:eg,__importStar:tg,__importDefault:rg,__classPrivateFieldGet:ng,__classPrivateFieldSet:ig}),og=Kt(sg),At={},Zo;function ag(){if(Zo)return At;Zo=1,Object.defineProperty(At,"__esModule",{value:!0}),At.isBrowserCryptoAvailable=At.getSubtleCrypto=At.getBrowerCrypto=void 0;function t(){return et?.crypto||et?.msCrypto||{}}At.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}At.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return At.isBrowserCryptoAvailable=r,At}var Pt={},Qo;function cg(){if(Qo)return Pt;Qo=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.isBrowser=Pt.isNode=Pt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Pt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Pt.isNode=e;function r(){return!t()&&!e()}return Pt.isBrowser=r,Pt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=og;e.__exportStar(ag(),t),e.__exportStar(cg(),t)})(Xo);function ug(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function fn(t,e,r){return{id:r||ug(),jsonrpc:"2.0",method:t,params:e}}function Oi(t,e){return{id:t,jsonrpc:"2.0",result:e}}function xi(t,e,r){return{id:t,jsonrpc:"2.0",error:fg(e,r)}}function fg(t,e){return typeof t>"u"?ko(Wo):(typeof t=="string"&&(t=Object.assign(Object.assign({},ko(mi)),{message:t})),typeof e<"u"&&(t.data=e),$p(t.code)&&(t=Mp(t.code)),t)}class hg{}class lg extends hg{constructor(){super()}}class dg extends lg{constructor(e){super()}}const pg="^wss?:";function gg(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function _g(t,e){const r=gg(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function ea(t){return _g(t,pg)}function yg(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function ta(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Ii(t){return ta(t)&&"method"in t}function Ti(t){return ta(t)&&(Rt(t)||mt(t))}function Rt(t){return"result"in t}function mt(t){return"error"in t}class bg extends dg{constructor(e){super(e),this.events=new ut.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(fn(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{mt(s)?i(s.error):n(s.result)});try{await this.connection.send(e,r)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Ti(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}const ra=10,wg=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),vg=()=>typeof window<"u",mg=wg();class Eg{constructor(e){if(this.url=e,this.events=new ut.exports.EventEmitter,this.registering=!1,!ea(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=()=>{this.onClose(),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Gn(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!ea(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=Xo.isReactNative()?void 0:{rejectUnauthorized:!yg(e)},s=new mg(e,[],i);vg()?s.onerror=a=>{const c=a;n(this.emitError(c.error))}:s.on("error",a=>{n(this.emitError(a))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=()=>this.onClose(),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Ps(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=xi(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return jp(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>ra&&this.events.setMaxListeners(ra)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Ni={exports:{}};(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,s=2,a=9007199254740991,c="[object Arguments]",h="[object Array]",f="[object AsyncFunction]",l="[object Boolean]",m="[object Date]",b="[object Error]",y="[object Function]",S="[object GeneratorFunction]",P="[object Map]",R="[object Number]",j="[object Null]",E="[object Object]",x="[object Promise]",g="[object Proxy]",v="[object RegExp]",w="[object Set]",o="[object String]",p="[object Symbol]",F="[object Undefined]",z="[object WeakMap]",k="[object ArrayBuffer]",X="[object DataView]",J="[object Float32Array]",A="[object Float64Array]",N="[object Int8Array]",W="[object Int16Array]",M="[object Int32Array]",L="[object Uint8Array]",U="[object Uint8ClampedArray]",$="[object Uint16Array]",B="[object Uint32Array]",ne=/[\\^$.*+?()[\]{}|]/g,q=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,Y={};Y[J]=Y[A]=Y[N]=Y[W]=Y[M]=Y[L]=Y[U]=Y[$]=Y[B]=!0,Y[c]=Y[h]=Y[k]=Y[l]=Y[X]=Y[m]=Y[b]=Y[y]=Y[P]=Y[R]=Y[E]=Y[v]=Y[w]=Y[o]=Y[z]=!1;var ae=typeof et=="object"&&et&&et.Object===Object&&et,T=typeof self=="object"&&self&&self.Object===Object&&self,I=ae||T||Function("return this")(),D=e&&!e.nodeType&&e,u=D&&!0&&t&&!t.nodeType&&t,_=u&&u.exports===D,K=_&&ae.process,V=function(){try{return K&&K.binding&&K.binding("util")}catch{}}(),he=V&&V.isTypedArray;function ye(d,O){for(var C=-1,G=d==null?0:d.length,Te=0,ie=[];++C<G;){var Le=d[C];O(Le,C,d)&&(ie[Te++]=Le)}return ie}function de(d,O){for(var C=-1,G=O.length,Te=d.length;++C<G;)d[Te+C]=O[C];return d}function ve(d,O){for(var C=-1,G=d==null?0:d.length;++C<G;)if(O(d[C],C,d))return!0;return!1}function Ue(d,O){for(var C=-1,G=Array(d);++C<d;)G[C]=O(C);return G}function Pe(d){return function(O){return d(O)}}function _e(d,O){return d.has(O)}function pe(d,O){return d?.[O]}function le(d){var O=-1,C=Array(d.size);return d.forEach(function(G,Te){C[++O]=[Te,G]}),C}function ue(d,O){return function(C){return d(O(C))}}function ce(d){var O=-1,C=Array(d.size);return d.forEach(function(G){C[++O]=G}),C}var oe=Array.prototype,se=Function.prototype,ee=Object.prototype,fe=I["__core-js_shared__"],ge=se.toString,re=ee.hasOwnProperty,be=function(){var d=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),we=ee.toString,Ee=RegExp("^"+ge.call(re).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Se=_?I.Buffer:void 0,me=I.Symbol,Et=I.Uint8Array,Nt=ee.propertyIsEnumerable,jt=oe.splice,gt=me?me.toStringTag:void 0,Zt=Object.getOwnPropertySymbols,jr=Se?Se.isBuffer:void 0,bn=ue(Object.keys,Object),$e=fr(I,"DataView"),Re=fr(I,"Map"),Me=fr(I,"Promise"),je=fr(I,"Set"),ze=fr(I,"WeakMap"),Ce=fr(Object,"create"),Ge=er($e),We=er(Re),Ye=er(Me),ke=er(je),Xe=er(ze),qe=me?me.prototype:void 0,Be=qe?qe.valueOf:void 0;function Ne(d){var O=-1,C=d==null?0:d.length;for(this.clear();++O<C;){var G=d[O];this.set(G[0],G[1])}}function Je(){this.__data__=Ce?Ce(null):{},this.size=0}function Ze(d){var O=this.has(d)&&delete this.__data__[d];return this.size-=O?1:0,O}function cy(d){var O=this.__data__;if(Ce){var C=O[d];return C===n?void 0:C}return re.call(O,d)?O[d]:void 0}function uy(d){var O=this.__data__;return Ce?O[d]!==void 0:re.call(O,d)}function fy(d,O){var C=this.__data__;return this.size+=this.has(d)?0:1,C[d]=Ce&&O===void 0?n:O,this}Ne.prototype.clear=Je,Ne.prototype.delete=Ze,Ne.prototype.get=cy,Ne.prototype.has=uy,Ne.prototype.set=fy;function Ct(d){var O=-1,C=d==null?0:d.length;for(this.clear();++O<C;){var G=d[O];this.set(G[0],G[1])}}function hy(){this.__data__=[],this.size=0}function ly(d){var O=this.__data__,C=vn(O,d);if(C<0)return!1;var G=O.length-1;return C==G?O.pop():jt.call(O,C,1),--this.size,!0}function dy(d){var O=this.__data__,C=vn(O,d);return C<0?void 0:O[C][1]}function py(d){return vn(this.__data__,d)>-1}function gy(d,O){var C=this.__data__,G=vn(C,d);return G<0?(++this.size,C.push([d,O])):C[G][1]=O,this}Ct.prototype.clear=hy,Ct.prototype.delete=ly,Ct.prototype.get=dy,Ct.prototype.has=py,Ct.prototype.set=gy;function Qt(d){var O=-1,C=d==null?0:d.length;for(this.clear();++O<C;){var G=d[O];this.set(G[0],G[1])}}function _y(){this.size=0,this.__data__={hash:new Ne,map:new(Re||Ct),string:new Ne}}function yy(d){var O=mn(this,d).delete(d);return this.size-=O?1:0,O}function by(d){return mn(this,d).get(d)}function wy(d){return mn(this,d).has(d)}function vy(d,O){var C=mn(this,d),G=C.size;return C.set(d,O),this.size+=C.size==G?0:1,this}Qt.prototype.clear=_y,Qt.prototype.delete=yy,Qt.prototype.get=by,Qt.prototype.has=wy,Qt.prototype.set=vy;function wn(d){var O=-1,C=d==null?0:d.length;for(this.__data__=new Qt;++O<C;)this.add(d[O])}function my(d){return this.__data__.set(d,n),this}function Ey(d){return this.__data__.has(d)}wn.prototype.add=wn.prototype.push=my,wn.prototype.has=Ey;function zt(d){var O=this.__data__=new Ct(d);this.size=O.size}function Sy(){this.__data__=new Ct,this.size=0}function Dy(d){var O=this.__data__,C=O.delete(d);return this.size=O.size,C}function Oy(d){return this.__data__.get(d)}function xy(d){return this.__data__.has(d)}function Iy(d,O){var C=this.__data__;if(C instanceof Ct){var G=C.__data__;if(!Re||G.length<r-1)return G.push([d,O]),this.size=++C.size,this;C=this.__data__=new Qt(G)}return C.set(d,O),this.size=C.size,this}zt.prototype.clear=Sy,zt.prototype.delete=Dy,zt.prototype.get=Oy,zt.prototype.has=xy,zt.prototype.set=Iy;function Ty(d,O){var C=En(d),G=!C&&Ky(d),Te=!C&&!G&&zi(d),ie=!C&&!G&&!Te&&Ja(d),Le=C||G||Te||ie,Qe=Le?Ue(d.length,String):[],nt=Qe.length;for(var Ae in d)(O||re.call(d,Ae))&&!(Le&&(Ae=="length"||Te&&(Ae=="offset"||Ae=="parent")||ie&&(Ae=="buffer"||Ae=="byteLength"||Ae=="byteOffset")||My(Ae,nt)))&&Qe.push(Ae);return Qe}function vn(d,O){for(var C=d.length;C--;)if(Wa(d[C][0],O))return C;return-1}function Ny(d,O,C){var G=O(d);return En(d)?G:de(G,C(d))}function zr(d){return d==null?d===void 0?F:j:gt&&gt in Object(d)?Uy(d):qy(d)}function Ka(d){return Br(d)&&zr(d)==c}function Ha(d,O,C,G,Te){return d===O?!0:d==null||O==null||!Br(d)&&!Br(O)?d!==d&&O!==O:Ay(d,O,C,G,Ha,Te)}function Ay(d,O,C,G,Te,ie){var Le=En(d),Qe=En(O),nt=Le?h:Bt(d),Ae=Qe?h:Bt(O);nt=nt==c?E:nt,Ae=Ae==c?E:Ae;var _t=nt==E,St=Ae==E,st=nt==Ae;if(st&&zi(d)){if(!zi(O))return!1;Le=!0,_t=!1}if(st&&!_t)return ie||(ie=new zt),Le||Ja(d)?Va(d,O,C,G,Te,ie):Ly(d,O,nt,C,G,Te,ie);if(!(C&i)){var wt=_t&&re.call(d,"__wrapped__"),vt=St&&re.call(O,"__wrapped__");if(wt||vt){var qt=wt?d.value():d,Lt=vt?O.value():O;return ie||(ie=new zt),Te(qt,Lt,C,G,ie)}}return st?(ie||(ie=new zt),Fy(d,O,C,G,Te,ie)):!1}function Py(d){if(!Xa(d)||zy(d))return!1;var O=Ya(d)?Ee:q;return O.test(er(d))}function Ry(d){return Br(d)&&ka(d.length)&&!!Y[zr(d)]}function Cy(d){if(!By(d))return bn(d);var O=[];for(var C in Object(d))re.call(d,C)&&C!="constructor"&&O.push(C);return O}function Va(d,O,C,G,Te,ie){var Le=C&i,Qe=d.length,nt=O.length;if(Qe!=nt&&!(Le&&nt>Qe))return!1;var Ae=ie.get(d);if(Ae&&ie.get(O))return Ae==O;var _t=-1,St=!0,st=C&s?new wn:void 0;for(ie.set(d,O),ie.set(O,d);++_t<Qe;){var wt=d[_t],vt=O[_t];if(G)var qt=Le?G(vt,wt,_t,O,d,ie):G(wt,vt,_t,d,O,ie);if(qt!==void 0){if(qt)continue;St=!1;break}if(st){if(!ve(O,function(Lt,tr){if(!_e(st,tr)&&(wt===Lt||Te(wt,Lt,C,G,ie)))return st.push(tr)})){St=!1;break}}else if(!(wt===vt||Te(wt,vt,C,G,ie))){St=!1;break}}return ie.delete(d),ie.delete(O),St}function Ly(d,O,C,G,Te,ie,Le){switch(C){case X:if(d.byteLength!=O.byteLength||d.byteOffset!=O.byteOffset)return!1;d=d.buffer,O=O.buffer;case k:return!(d.byteLength!=O.byteLength||!ie(new Et(d),new Et(O)));case l:case m:case R:return Wa(+d,+O);case b:return d.name==O.name&&d.message==O.message;case v:case o:return d==O+"";case P:var Qe=le;case w:var nt=G&i;if(Qe||(Qe=ce),d.size!=O.size&&!nt)return!1;var Ae=Le.get(d);if(Ae)return Ae==O;G|=s,Le.set(d,O);var _t=Va(Qe(d),Qe(O),G,Te,ie,Le);return Le.delete(d),_t;case p:if(Be)return Be.call(d)==Be.call(O)}return!1}function Fy(d,O,C,G,Te,ie){var Le=C&i,Qe=Ga(d),nt=Qe.length,Ae=Ga(O),_t=Ae.length;if(nt!=_t&&!Le)return!1;for(var St=nt;St--;){var st=Qe[St];if(!(Le?st in O:re.call(O,st)))return!1}var wt=ie.get(d);if(wt&&ie.get(O))return wt==O;var vt=!0;ie.set(d,O),ie.set(O,d);for(var qt=Le;++St<nt;){st=Qe[St];var Lt=d[st],tr=O[st];if(G)var Za=Le?G(tr,Lt,st,O,d,ie):G(Lt,tr,st,d,O,ie);if(!(Za===void 0?Lt===tr||Te(Lt,tr,C,G,ie):Za)){vt=!1;break}qt||(qt=st=="constructor")}if(vt&&!qt){var Sn=d.constructor,Dn=O.constructor;Sn!=Dn&&"constructor"in d&&"constructor"in O&&!(typeof Sn=="function"&&Sn instanceof Sn&&typeof Dn=="function"&&Dn instanceof Dn)&&(vt=!1)}return ie.delete(d),ie.delete(O),vt}function Ga(d){return Ny(d,Gy,$y)}function mn(d,O){var C=d.__data__;return jy(O)?C[typeof O=="string"?"string":"hash"]:C.map}function fr(d,O){var C=pe(d,O);return Py(C)?C:void 0}function Uy(d){var O=re.call(d,gt),C=d[gt];try{d[gt]=void 0;var G=!0}catch{}var Te=we.call(d);return G&&(O?d[gt]=C:delete d[gt]),Te}var $y=Zt?function(d){return d==null?[]:(d=Object(d),ye(Zt(d),function(O){return Nt.call(d,O)}))}:Wy,Bt=zr;($e&&Bt(new $e(new ArrayBuffer(1)))!=X||Re&&Bt(new Re)!=P||Me&&Bt(Me.resolve())!=x||je&&Bt(new je)!=w||ze&&Bt(new ze)!=z)&&(Bt=function(d){var O=zr(d),C=O==E?d.constructor:void 0,G=C?er(C):"";if(G)switch(G){case Ge:return X;case We:return P;case Ye:return x;case ke:return w;case Xe:return z}return O});function My(d,O){return O=O??a,!!O&&(typeof d=="number"||Q.test(d))&&d>-1&&d%1==0&&d<O}function jy(d){var O=typeof d;return O=="string"||O=="number"||O=="symbol"||O=="boolean"?d!=="__proto__":d===null}function zy(d){return!!be&&be in d}function By(d){var O=d&&d.constructor,C=typeof O=="function"&&O.prototype||ee;return d===C}function qy(d){return we.call(d)}function er(d){if(d!=null){try{return ge.call(d)}catch{}try{return d+""}catch{}}return""}function Wa(d,O){return d===O||d!==d&&O!==O}var Ky=Ka(function(){return arguments}())?Ka:function(d){return Br(d)&&re.call(d,"callee")&&!Nt.call(d,"callee")},En=Array.isArray;function Hy(d){return d!=null&&ka(d.length)&&!Ya(d)}var zi=jr||Yy;function Vy(d,O){return Ha(d,O)}function Ya(d){if(!Xa(d))return!1;var O=zr(d);return O==y||O==S||O==f||O==g}function ka(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=a}function Xa(d){var O=typeof d;return d!=null&&(O=="object"||O=="function")}function Br(d){return d!=null&&typeof d=="object"}var Ja=he?Pe(he):Ry;function Gy(d){return Hy(d)?Ty(d):Cy(d)}function Wy(){return[]}function Yy(){return!1}t.exports=Vy})(Ni,Ni.exports);var Sg=Ni.exports,Dg=Object.defineProperty,na=Object.getOwnPropertySymbols,Og=Object.prototype.hasOwnProperty,xg=Object.prototype.propertyIsEnumerable,ia=(t,e,r)=>e in t?Dg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ct=(t,e)=>{for(var r in e||(e={}))Og.call(e,r)&&ia(t,r,e[r]);if(na)for(var r of na(e))xg.call(e,r)&&ia(t,r,e[r]);return t};function Ig(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var c=t.length,h=t.charAt(0),f=Math.log(c)/Math.log(256),l=Math.log(256)/Math.log(c);function m(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var P=0,R=0,j=0,E=S.length;j!==E&&S[j]===0;)j++,P++;for(var x=(E-j)*l+1>>>0,g=new Uint8Array(x);j!==E;){for(var v=S[j],w=0,o=x-1;(v!==0||w<R)&&o!==-1;o--,w++)v+=256*g[o]>>>0,g[o]=v%c>>>0,v=v/c>>>0;if(v!==0)throw new Error("Non-zero carry");R=w,j++}for(var p=x-R;p!==x&&g[p]===0;)p++;for(var F=h.repeat(P);p<x;++p)F+=t.charAt(g[p]);return F}function b(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var P=0;if(S[P]!==" "){for(var R=0,j=0;S[P]===h;)R++,P++;for(var E=(S.length-P)*f+1>>>0,x=new Uint8Array(E);S[P];){var g=r[S.charCodeAt(P)];if(g===255)return;for(var v=0,w=E-1;(g!==0||v<j)&&w!==-1;w--,v++)g+=c*x[w]>>>0,x[w]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");j=v,P++}if(S[P]!==" "){for(var o=E-j;o!==E&&x[o]===0;)o++;for(var p=new Uint8Array(R+(E-o)),F=R;o!==E;)p[F++]=x[o++];return p}}}function y(S){var P=b(S);if(P)return P;throw new Error(`Non-${e} character`)}return{encode:m,decodeUnsafe:b,decode:y}}var Tg=Ig,Ng=Tg;const sa=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Ag=t=>new TextEncoder().encode(t),Pg=t=>new TextDecoder().decode(t);class Rg{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Cg{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return oa(this,e)}}class Lg{constructor(e){this.decoders=e}or(e){return oa(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const oa=(t,e)=>new Lg(ct(ct({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class Fg{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Rg(e,r,n),this.decoder=new Cg(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const hn=({name:t,prefix:e,encode:r,decode:n})=>new Fg(t,e,r,n),Fr=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=Ng(r,e);return hn({prefix:t,name:e,encode:n,decode:s=>sa(i(s))})},Ug=(t,e,r,n)=>{const i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,h=0,f=0;for(let l=0;l<s;++l){const m=i[t[l]];if(m===void 0)throw new SyntaxError(`Non-${n} character`);h=h<<r|m,c+=r,c>=8&&(c-=8,a[f++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return a},$g=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",a=0,c=0;for(let h=0;h<t.length;++h)for(c=c<<8|t[h],a+=8;a>r;)a-=r,s+=e[i&c>>a];if(a&&(s+=e[i&c<<r-a]),n)for(;s.length*r&7;)s+="=";return s},rt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>hn({prefix:e,name:t,encode(i){return $g(i,n,r)},decode(i){return Ug(i,n,r,t)}}),Mg=hn({prefix:"\0",name:"identity",encode:t=>Pg(t),decode:t=>Ag(t)});var jg=Object.freeze({__proto__:null,identity:Mg});const zg=rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Bg=Object.freeze({__proto__:null,base2:zg});const qg=rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Kg=Object.freeze({__proto__:null,base8:qg});const Hg=Fr({prefix:"9",name:"base10",alphabet:"0123456789"});var Vg=Object.freeze({__proto__:null,base10:Hg});const Gg=rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Wg=rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Yg=Object.freeze({__proto__:null,base16:Gg,base16upper:Wg});const kg=rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Xg=rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Jg=rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Zg=rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Qg=rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),e0=rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),t0=rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),r0=rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),n0=rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var i0=Object.freeze({__proto__:null,base32:kg,base32upper:Xg,base32pad:Jg,base32padupper:Zg,base32hex:Qg,base32hexupper:e0,base32hexpad:t0,base32hexpadupper:r0,base32z:n0});const s0=Fr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),o0=Fr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var a0=Object.freeze({__proto__:null,base36:s0,base36upper:o0});const c0=Fr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),u0=Fr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var f0=Object.freeze({__proto__:null,base58btc:c0,base58flickr:u0});const h0=rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),l0=rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),d0=rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),p0=rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var g0=Object.freeze({__proto__:null,base64:h0,base64pad:l0,base64url:d0,base64urlpad:p0});const aa=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),_0=aa.reduce((t,e,r)=>(t[r]=e,t),[]),y0=aa.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function b0(t){return t.reduce((e,r)=>(e+=_0[r],e),"")}function w0(t){const e=[];for(const r of t){const n=y0[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const v0=hn({prefix:"\u{1F680}",name:"base256emoji",encode:b0,decode:w0});var m0=Object.freeze({__proto__:null,base256emoji:v0}),E0=ua,ca=128,S0=127,D0=~S0,O0=Math.pow(2,31);function ua(t,e,r){e=e||[],r=r||0;for(var n=r;t>=O0;)e[r++]=t&255|ca,t/=128;for(;t&D0;)e[r++]=t&255|ca,t>>>=7;return e[r]=t|0,ua.bytes=r-n+1,e}var x0=Ai,I0=128,fa=127;function Ai(t,n){var r=0,n=n||0,i=0,s=n,a,c=t.length;do{if(s>=c)throw Ai.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=i<28?(a&fa)<<i:(a&fa)*Math.pow(2,i),i+=7}while(a>=I0);return Ai.bytes=s-n,r}var T0=Math.pow(2,7),N0=Math.pow(2,14),A0=Math.pow(2,21),P0=Math.pow(2,28),R0=Math.pow(2,35),C0=Math.pow(2,42),L0=Math.pow(2,49),F0=Math.pow(2,56),U0=Math.pow(2,63),$0=function(t){return t<T0?1:t<N0?2:t<A0?3:t<P0?4:t<R0?5:t<C0?6:t<L0?7:t<F0?8:t<U0?9:10},M0={encode:E0,decode:x0,encodingLength:$0},ha=M0;const la=(t,e,r=0)=>(ha.encode(t,e,r),e),da=t=>ha.encodingLength(t),Pi=(t,e)=>{const r=e.byteLength,n=da(t),i=n+da(r),s=new Uint8Array(i+r);return la(t,s,0),la(r,s,n),s.set(e,i),new j0(t,r,e,s)};class j0{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const pa=({name:t,code:e,encode:r})=>new z0(t,e,r);class z0{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Pi(this.code,r):r.then(n=>Pi(this.code,n))}else throw Error("Unknown type, must be binary type")}}const ga=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),B0=pa({name:"sha2-256",code:18,encode:ga("SHA-256")}),q0=pa({name:"sha2-512",code:19,encode:ga("SHA-512")});var K0=Object.freeze({__proto__:null,sha256:B0,sha512:q0});const _a=0,H0="identity",ya=sa;var V0=Object.freeze({__proto__:null,identity:{code:_a,name:H0,encode:ya,digest:t=>Pi(_a,ya(t))}});new TextEncoder,new TextDecoder;const ba=ct(ct(ct(ct(ct(ct(ct(ct(ct(ct({},jg),Bg),Kg),Vg),Yg),i0),a0),f0),g0),m0);ct(ct({},K0),V0);function G0(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function wa(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const va=wa("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ri=wa("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=G0(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),W0=ct({utf8:va,"utf-8":va,hex:ba.base16,latin1:Ri,ascii:Ri,binary:Ri},ba);function Y0(t,e="utf8"){const r=W0[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const ma="wc",k0=2,Ci="core",Mt=`${ma}@${2}:${Ci}:`,X0={name:Ci,logger:"error"},J0={database:":memory:"},Z0="crypto",Ea="client_ed25519_seed",Q0=Z.ONE_DAY,e_="keychain",t_="0.3",r_="messages",n_="0.3",i_=Z.SIX_HOURS,s_="publisher",Sa="irn",o_="error",Da="wss://relay.walletconnect.com",a_="relayer",Ve={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},c_="_subscription",ln={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Oa=Z.ONE_SECOND,u_="2.4.6",f_="0.3",It={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},h_="subscription",l_="0.3",d_=Z.FIVE_SECONDS*1e3,p_="pairing",g_="0.3",Ur={wc_pairingDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:0},res:{ttl:Z.ONE_DAY,prompt:!1,tag:0}}},Tt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},__="history",y_="0.3",b_="expirer",yt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},w_="0.3";class v_{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=e_,this.version=t_,this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=H("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=e,this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,$o(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Mo(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class m_{constructor(e,r,n){this.core=e,this.logger=r,this.name=Z0,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=co(i);return ao(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=xd();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),a=co(s),c=pi();return await Ll(c,i,Q0,a)},this.generateSharedKey=(i,s,a)=>{this.isInitialized();const c=this.getPrivateKey(i),h=Id(c,s);return this.setSymKey(h,a)},this.setSymKey=async(i,s)=>{this.isInitialized();const a=s||Td(i);return await this.keychain.set(a,i),a},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,a)=>{this.isInitialized();const c=Po(a),h=Gn(s);if(Ro(c)){const b=c.senderPublicKey,y=c.receiverPublicKey;i=await this.generateSharedKey(b,y)}const f=this.getSymKey(i),{type:l,senderPublicKey:m}=c;return Ad({type:l,symKey:f,message:h,senderPublicKey:m})},this.decode=async(i,s,a)=>{this.isInitialized();const c=Cd(s,a);if(Ro(c)){const l=c.receiverPublicKey,m=c.senderPublicKey;i=await this.generateSharedKey(l,m)}const h=this.getSymKey(i),f=Pd({symKey:h,encoded:s});return Ps(f)},this.core=e,this.logger=Oe.generateChildLogger(r,this.name),this.keychain=n||new v_(this.core,this.logger)}get context(){return Oe.getLoggerContext(this.logger)}getPayloadType(e){const r=gi(e);return Nr(r.type)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Ea)}catch{e=pi(),await this.keychain.set(Ea,e)}return Y0(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class E_ extends yf{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=r_,this.version=n_,this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=on(i);let a=this.messages.get(n);return typeof a>"u"&&(a={}),typeof a[s]<"u"||(a[s]=i,this.messages.set(n,a),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),a=on(i);return typeof s[a]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Oe.generateChildLogger(e,this.name),this.core=r}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,$o(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Mo(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class S_ extends bf{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new ut.exports.EventEmitter,this.name=s_,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(n,i,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const a=s?.ttl||i_,c=yi(s),h=s?.prompt||!1,f=s?.tag||0,l={topic:n,message:i,opts:{ttl:a,relay:c,prompt:h,tag:f}},m=on(i);this.queue.set(m,l);try{await await _i(this.rpcPublish(n,i,a,c,h,f),this.publishTimeout),this.relayer.events.emit(Ve.publish,l)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(Ve.connection_stalled);return}this.onPublish(m,l),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(a){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(a),a}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=e,this.logger=Oe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Oe.getLoggerContext(this.logger)}rpcPublish(e,r,n,i,s,a){var c,h,f,l;const m={method:an(i.protocol).publish,params:{topic:e,message:r,ttl:n,prompt:s,tag:a}};return at((c=m.params)==null?void 0:c.prompt)&&((h=m.params)==null||delete h.prompt),at((f=m.params)==null?void 0:f.tag)&&((l=m.params)==null||delete l.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:m}),this.relayer.provider.request(m)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:n,opts:i}=e;await this.publish(r,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(br.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class D_{constructor(){this.map=new Map,this.set=(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var O_=Object.defineProperty,x_=Object.defineProperties,I_=Object.getOwnPropertyDescriptors,xa=Object.getOwnPropertySymbols,T_=Object.prototype.hasOwnProperty,N_=Object.prototype.propertyIsEnumerable,Ia=(t,e,r)=>e in t?O_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$r=(t,e)=>{for(var r in e||(e={}))T_.call(e,r)&&Ia(t,r,e[r]);if(xa)for(var r of xa(e))N_.call(e,r)&&Ia(t,r,e[r]);return t},Li=(t,e)=>x_(t,I_(e));class A_ extends mf{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new D_,this.events=new ut.exports.EventEmitter,this.name=h_,this.version=l_,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Mt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=yi(i),a={topic:n,relay:s};this.pending.set(n,a);const c=await this.rpcSubscribe(n,s);return this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),c}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const a=new Z.Watch;a.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(c),a.stop(this.pendingSubscriptionWatchLabel),i(!0)),a.elapsed(this.pendingSubscriptionWatchLabel)>=d_&&(clearInterval(c),a.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pollingInterval)}),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Oe.generateChildLogger(r,this.name),this.clientId=""}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=yi(n);await this.rpcUnsubscribe(e,r,i);const s=Ke("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r){const n={method:an(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await _i(this.relayer.provider.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ve.connection_stalled)}return on(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:an(r.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await _i(this.relayer.provider.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ve.connection_stalled)}}rpcUnsubscribe(e,r,n){const i={method:an(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.provider.request(i)}onSubscribe(e,r){this.setSubscription(e,Li($r({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,$r({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,$r({},r)),this.topicMap.set(r.topic,e),this.events.emit(It.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(It.deleted,Li($r({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(It.sync)}async reset(){if(!this.cached.length)return;const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}this.events.emit(It.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);this.onBatchSubscribe(r.map((n,i)=>Li($r({},e[i]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(br.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ve.connect,async()=>{await this.onConnect()}),this.relayer.on(Ve.disconnect,()=>{this.onDisconnect()}),this.events.on(It.created,async e=>{const r=It.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(It.deleted,async e=>{const r=It.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var P_=Object.defineProperty,Ta=Object.getOwnPropertySymbols,R_=Object.prototype.hasOwnProperty,C_=Object.prototype.propertyIsEnumerable,Na=(t,e,r)=>e in t?P_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,L_=(t,e)=>{for(var r in e||(e={}))R_.call(e,r)&&Na(t,r,e[r]);if(Ta)for(var r of Ta(e))C_.call(e,r)&&Na(t,r,e[r]);return t};class F_ extends wf{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ut.exports.EventEmitter,this.name=a_,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Oe.generateChildLogger(e.logger,this.name):qr(Oe.getDefaultLoggerOptions({level:e.logger||o_})),this.messages=new E_(this.logger,e.core),this.subscriber=new A_(this,this.logger),this.publisher=new S_(this,this.logger),this.relayUrl=e?.relayUrl||Da,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Oe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){this.isInitialized();let n="";return await Promise.all([new Promise(i=>{this.subscriber.once(It.created,s=>{s.topic===e&&i()})}),new Promise(async i=>{n=await this.subscriber.subscribe(e,r),i()})]),n}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ve.transport_closed))}async transportOpen(e){if(!this.reconnecting){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(It.resubscribed,()=>{r()})}),await Promise.race([new Promise(async r=>{await this.provider.connect(),this.removeListener(Ve.transport_closed,this.rejectTransportOpen),r()}),new Promise(r=>this.once(Ve.transport_closed,this.rejectTransportOpen))])])}catch(r){const n=r;if(!/socket hang up/i.test(n.message))throw r;this.logger.error(r),this.events.emit(Ve.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(await this.transportClose(),await new Promise(r=>setTimeout(r,Oa)),await this.transportOpen(e))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);return new bg(new Eg(Wd({sdkVersion:u_,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:r,message:n}=e;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Ii(e)){if(!e.method.endsWith(c_))return;const r=e.params,{topic:n,message:i,publishedAt:s}=r.data,a={topic:n,message:i,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(L_({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Ve.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Oi(e.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(ln.payload,e=>this.onProviderPayload(e)),this.provider.on(ln.connect,()=>{this.events.emit(Ve.connect)}),this.provider.on(ln.disconnect,()=>{this.events.emit(Ve.disconnect),this.attemptToReconnect()}),this.provider.on(ln.error,e=>this.events.emit(Ve.error,e)),this.events.on(Ve.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},Z.toMiliseconds(Oa))}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var U_=Object.defineProperty,Aa=Object.getOwnPropertySymbols,$_=Object.prototype.hasOwnProperty,M_=Object.prototype.propertyIsEnumerable,Pa=(t,e,r)=>e in t?U_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ra=(t,e)=>{for(var r in e||(e={}))$_.call(e,r)&&Pa(t,r,e[r]);if(Aa)for(var r of Aa(e))M_.call(e,r)&&Pa(t,r,e[r]);return t};class dn extends vf{constructor(e,r,n,i=Mt,s=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,this.map=new Map,this.version=f_,this.cached=[],this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>{pp(a)?this.map.set(a.id,a):gp(a)?this.map.set(a.topic,a):this.getKey&&a!==null&&!at(a)&&this.map.set(this.getKey(a),a)}),this.cached=[],this.initialized=!0)},this.set=async(a,c)=>{this.isInitialized(),this.map.has(a)?await this.update(a,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:a,value:c}),this.map.set(a,c),await this.persist())},this.get=a=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:a}),this.getData(a)),this.getAll=a=>(this.isInitialized(),a?this.values.filter(c=>Object.keys(a).every(h=>Sg(c[h],a[h]))):this.values),this.update=async(a,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:a,update:c});const h=Ra(Ra({},this.getData(a)),c);this.map.set(a,h),await this.persist()},this.delete=async(a,c)=>{this.isInitialized(),this.map.has(a)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:a,reason:c}),this.map.delete(a),await this.persist())},this.logger=Oe.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class j_{constructor(e,r){this.core=e,this.logger=r,this.name=p_,this.version=g_,this.events=new ut.exports,this.initialized=!1,this.storagePrefix=Mt,this.ignoredPayloadTypes=[Xt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=pi(),i=await this.core.crypto.setSymKey(n),s=xt(Z.FIVE_MINUTES),a={protocol:Sa},c={topic:i,expiry:s,relay:a,active:!1},h=ip({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:a});return await this.pairings.set(i,c),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:h}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:a}=rp(n.uri),c=xt(Z.FIVE_MINUTES),h={topic:i,relay:a,expiry:c,active:!1};return await this.pairings.set(i,h),await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:a}),this.core.expirer.set(i,c),n.activatePairing&&await this.activate({topic:i}),h},this.activate=async({topic:n})=>{this.isInitialized();const i=xt(Z.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:a,resolve:c,reject:h}=Jt();this.events.once(Fe("pairing_ping",s),({error:f})=>{f?h(f):c()}),await a()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Ke("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const a=fn(i,s),c=await this.core.crypto.encode(n,a),h=Ur[i].req;return this.core.history.set(n,a),await this.core.relayer.publish(n,c,h),a.id},this.sendResult=async(n,i,s)=>{const a=Oi(n,s),c=await this.core.crypto.encode(i,a),h=await this.core.history.get(i,n),f=Ur[h.request.method].res;await this.core.relayer.publish(i,c,f),await this.core.history.resolve(a)},this.sendError=async(n,i,s)=>{const a=xi(n,s),c=await this.core.crypto.encode(i,a),h=await this.core.history.get(i,n),f=Ur[h.request.method]?Ur[h.request.method].res:Ur.unregistered_method.res;await this.core.relayer.publish(i,c,f),await this.core.history.resolve(a)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Ke("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>$t(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n,a=s.method;if(this.pairings.keys.includes(i))switch(a){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,a=(await this.core.history.get(i,s.id)).request.method;if(this.pairings.keys.includes(i))switch(a){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(a)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit("pairing_ping",{id:s,topic:n})}catch(a){await this.sendError(s,n,a),this.logger.error(a)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{Rt(i)?this.events.emit(Fe("pairing_ping",s),{}):mt(i)&&this.events.emit(Fe("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:s,topic:n})}catch(a){await this.sendError(s,n,a),this.logger.error(a)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:a}=i;try{if(this.registeredMethods.includes(a))return;const c=Ke("WC_METHOD_UNSUPPORTED",a);await this.sendError(s,n,c),this.logger.error(c)}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Ke("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!dt(n)){const{message:i}=H("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!dp(n.uri)){const{message:i}=H("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!dt(n)){const{message:s}=H("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!dt(n)){const{message:s}=H("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!He(n,!1)){const{message:i}=H("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=H("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if($t(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=H("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=e,this.logger=Oe.generateChildLogger(r,this.name),this.pairings=new dn(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Oe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ve.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);Ii(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):Ti(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(yt.expired,async e=>{const{topic:r}=zo(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class z_ extends _f{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new ut.exports.EventEmitter,this.name=__,this.version=y_,this.cached=[],this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const a={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s};this.records.set(a.id,a),this.events.emit(Tt.created,a)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=mt(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(Tt.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(Tt.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:fn(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Tt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Tt.created,e=>{const r=Tt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Tt.updated,e=>{const r=Tt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Tt.deleted,e=>{const r=Tt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class B_ extends Ef{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new ut.exports.EventEmitter,this.name=b_,this.version=w_,this.cached=[],this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),a={target:s,expiry:i};this.expirations.set(s,a),this.checkExpiry(s,a),this.events.emit(yt.created,{target:s,expiration:a})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(yt.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Yd(e);if(typeof e=="number")return kd(e);const{message:r}=H("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(yt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;Z.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(yt.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(br.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(yt.created,e=>{const r=yt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(yt.expired,e=>{const r=yt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(yt.deleted,e=>{const r=yt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var q_=Object.defineProperty,Ca=Object.getOwnPropertySymbols,K_=Object.prototype.hasOwnProperty,H_=Object.prototype.propertyIsEnumerable,La=(t,e,r)=>e in t?q_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Fa=(t,e)=>{for(var r in e||(e={}))K_.call(e,r)&&La(t,r,e[r]);if(Ca)for(var r of Ca(e))H_.call(e,r)&&La(t,r,e[r]);return t};class Fi extends gf{constructor(e){super(e),this.protocol=ma,this.version=k0,this.name=Ci,this.events=new ut.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Da;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:qr(Oe.getDefaultLoggerOptions({level:e?.logger||X0.logger}));this.logger=Oe.generateChildLogger(r,this.name),this.heartbeat=new br.HeartBeat,this.crypto=new m_(this,this.logger,e?.keychain),this.history=new z_(this,this.logger),this.expirer=new B_(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Gc(Fa(Fa({},J0),e?.storageOptions)),this.relayer=new F_({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new j_(this,this.logger)}static async init(e){const r=new Fi(e);return await r.initialize(),r}get context(){return Oe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const V_=Fi,Ui="wc",$i=2,Mi="client",pn=`${Ui}@${$i}:${Mi}:`,gn={name:Mi,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},G_={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_request_sent:"session_request_sent",session_event:"session_event",proposal_expire:"proposal_expire"},W_={database:":memory:"},Y_={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},k_="history",X_="0.3",Ua="proposal",J_=Z.THIRTY_DAYS,$a="Proposal expired",Ma="session",Mr=Z.SEVEN_DAYS,ja="engine",ur={wc_sessionPropose:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1115}}},_n={min:Z.FIVE_MINUTES,max:Z.SEVEN_DAYS},za="request";var Z_=Object.defineProperty,Q_=Object.defineProperties,ey=Object.getOwnPropertyDescriptors,Ba=Object.getOwnPropertySymbols,ty=Object.prototype.hasOwnProperty,ry=Object.prototype.propertyIsEnumerable,qa=(t,e,r)=>e in t?Z_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bt=(t,e)=>{for(var r in e||(e={}))ty.call(e,r)&&qa(t,r,e[r]);if(Ba)for(var r of Ba(e))ry.call(e,r)&&qa(t,r,e[r]);return t},ji=(t,e)=>Q_(t,ey(e));class ny extends Df{constructor(e){super(e),this.name=ja,this.events=new ut.exports,this.initialized=!1,this.ignoredPayloadTypes=[Xt],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(ur)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const n=ji(bt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:c,relays:h}=n;let f=i,l,m=!1;if(f&&(m=this.client.core.pairing.pairings.get(f).active),!f||!m){const{topic:x,uri:g}=await this.client.core.pairing.create();f=x,l=g}const b=await this.client.core.crypto.generateKeyPair(),y=bt({requiredNamespaces:s,optionalNamespaces:a,relays:h??[{protocol:Sa}],proposer:{publicKey:b,metadata:this.client.metadata}},c&&{sessionProperties:c}),{reject:S,resolve:P,done:R}=Jt(Z.FIVE_MINUTES,$a);if(this.events.once(Fe("session_connect"),async({error:x,session:g})=>{if(x)S(x);else if(g){g.self.publicKey=b;const v=ji(bt({},g),{requiredNamespaces:g.requiredNamespaces,optionalNamespaces:g.optionalNamespaces});await this.client.session.set(g.topic,v),await this.setExpiry(g.topic,g.expiry),f&&await this.client.core.pairing.updateMetadata({topic:f,metadata:g.peer.metadata}),P(v)}}),!f){const{message:x}=H("NO_MATCHING_KEY",`connect() pairing topic: ${f}`);throw new Error(x)}const j=await this.sendRequest(f,"wc_sessionPropose",y),E=xt(Z.FIVE_MINUTES);return await this.setProposal(j,bt({id:j,expiry:E},y)),{uri:l,approval:R}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:i,namespaces:s,sessionProperties:a}=r,c=this.client.proposal.get(n);let{pairingTopic:h,proposer:f,requiredNamespaces:l,optionalNamespaces:m}=c;Rr(l)||(l=cp(s,"approve()"));const b=await this.client.core.crypto.generateKeyPair(),y=f.publicKey,S=await this.client.core.crypto.generateSharedKey(b,y);h&&n&&(await this.client.core.pairing.updateMetadata({topic:h,metadata:f.metadata}),await this.sendResult(n,h,{relay:{protocol:i??"irn"},responderPublicKey:b}),await this.client.proposal.delete(n,Ke("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:h}));const P=bt({relay:{protocol:i??"irn"},namespaces:s,requiredNamespaces:l,optionalNamespaces:m,controller:{publicKey:b,metadata:this.client.metadata},expiry:xt(Mr)},a&&{sessionProperties:a});await this.client.core.relayer.subscribe(S);const R=await this.sendRequest(S,"wc_sessionSettle",P),{done:j,resolve:E,reject:x}=Jt();this.events.once(Fe("session_approve",R),({error:v})=>{v?x(v):E(this.client.session.get(S))});const g=ji(bt({},P),{topic:S,acknowledged:!1,self:P.controller,peer:{publicKey:f.publicKey,metadata:f.metadata},controller:b});return await this.client.session.set(S,g),await this.setExpiry(S,xt(Mr)),{topic:S,acknowledged:j}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:n,reason:i}=r,{pairingTopic:s}=this.client.proposal.get(n);s&&(await this.sendError(n,s,i),await this.client.proposal.delete(n,Ke("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:i}=r,s=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:i}),{done:a,resolve:c,reject:h}=Jt();return this.events.once(Fe("session_update",s),({error:f})=>{f?h(f):c()}),await this.client.session.update(n,{namespaces:i}),{acknowledged:a}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,i=await this.sendRequest(n,"wc_sessionExtend",{}),{done:s,resolve:a,reject:c}=Jt();return this.events.once(Fe("session_extend",i),({error:h})=>{h?c(h):a()}),await this.setExpiry(n,xt(Mr)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:i,topic:s,expiry:a}=r,c=await this.sendRequest(s,"wc_sessionRequest",{request:i,chainId:n},a),{done:h,resolve:f,reject:l}=Jt(a);return this.events.once(Fe("session_request",c),({error:m,result:b})=>{m?l(m):f(b)}),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:n}),await h()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:i}=r,{id:s}=i;Rt(i)?await this.sendResult(s,n,i.result):mt(i)&&await this.sendError(s,n,i.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const i=await this.sendRequest(n,"wc_sessionPing",{}),{done:s,resolve:a,reject:c}=Jt();this.events.once(Fe("session_ping",i),({error:h})=>{h?c(h):a()}),await s()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:i,chainId:s}=r;await this.sendRequest(n,"wc_sessionEvent",{event:i,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest(n,"wc_sessionDelete",Ke("USER_DISCONNECTED")),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>hp(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,n)=>{const{self:i}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,Ke("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(i.publicKey),this.client.core.crypto.deleteSymKey(r),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Ke("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),i?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=ur.wc_sessionRequest.req.ttl,{id:i,topic:s,params:a}=r;await this.client.pendingRequest.set(i,{id:i,topic:s,params:a}),n&&this.client.core.expirer.set(i,xt(n))},this.sendRequest=async(r,n,i,s)=>{const a=fn(n,i),c=await this.client.core.crypto.encode(r,a),h=ur[n].req;return s&&(h.ttl=s),this.client.core.history.set(r,a),this.client.core.relayer.publish(r,c,h),a.id},this.sendResult=async(r,n,i)=>{const s=Oi(r,i),a=await this.client.core.crypto.encode(n,s),c=await this.client.core.history.get(n,r),h=ur[c.request.method].res;this.client.core.relayer.publish(n,a,h),await this.client.core.history.resolve(s)},this.sendError=async(r,n,i)=>{const s=xi(r,i),a=await this.client.core.crypto.encode(n,s),c=await this.client.core.history.get(n,r),h=ur[c.request.method].res;this.client.core.relayer.publish(n,a,h),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(i=>{$t(i.expiry)&&r.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{$t(i.expiry)&&n.push(i.id)}),await Promise.all([...r.map(i=>this.deleteSession(i)),...n.map(i=>this.deleteProposal(i))])},this.onRelayEventRequest=r=>{const{topic:n,payload:i}=r,s=i.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(n,i);case"wc_sessionSettle":return this.onSessionSettleRequest(n,i);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,i);case"wc_sessionExtend":return this.onSessionExtendRequest(n,i);case"wc_sessionPing":return this.onSessionPingRequest(n,i);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,i);case"wc_sessionRequest":return this.onSessionRequest(n,i);case"wc_sessionEvent":return this.onSessionEventRequest(n,i);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:i}=r,s=(await this.client.core.history.get(n,i.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(n,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,i);case"wc_sessionExtend":return this.onSessionExtendResponse(n,i);case"wc_sessionPing":return this.onSessionPingResponse(n,i);case"wc_sessionRequest":return this.onSessionRequestResponse(n,i);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidConnect(bt({},n.params));const a=xt(Z.FIVE_MINUTES),c=bt({id:s,pairingTopic:r,expiry:a},i);await this.setProposal(s,c),this.client.events.emit("session_proposal",{id:s,params:c})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionProposeResponse=async(r,n)=>{const{id:i}=n;if(Rt(n)){const{result:s}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const h=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:h});const f=await this.client.core.crypto.generateSharedKey(c,h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:f});const l=await this.client.core.relayer.subscribe(f);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:r})}else mt(n)&&(await this.client.proposal.delete(i,Ke("USER_DISCONNECTED")),this.events.emit(Fe("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidSessionSettleRequest(s);const{relay:a,controller:c,expiry:h,namespaces:f,requiredNamespaces:l,optionalNamespaces:m,sessionProperties:b}=n.params,y=bt({topic:r,relay:a,expiry:h,namespaces:f,acknowledged:!0,requiredNamespaces:l,optionalNamespaces:m,controller:c.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}},b&&{sessionProperties:b});await this.sendResult(n.id,r,!0),this.events.emit(Fe("session_connect"),{session:y})}catch(a){await this.sendError(i,r,a),this.client.logger.error(a)}},this.onSessionSettleResponse=async(r,n)=>{const{id:i}=n;Rt(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Fe("session_approve",i),{})):mt(n)&&(await this.client.session.delete(r,Ke("USER_DISCONNECTED")),this.events.emit(Fe("session_approve",i),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidUpdate(bt({topic:r},i)),await this.client.session.update(r,{namespaces:i.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:i})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionUpdateResponse=(r,n)=>{const{id:i}=n;Rt(n)?this.events.emit(Fe("session_update",i),{}):mt(n)&&this.events.emit(Fe("session_update",i),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:i}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,xt(Mr)),await this.sendResult(i,r,!0),this.client.events.emit("session_extend",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,n)=>{const{id:i}=n;Rt(n)?this.events.emit(Fe("session_extend",i),{}):mt(n)&&this.events.emit(Fe("session_extend",i),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:i}=n;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.client.events.emit("session_ping",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,n)=>{const{id:i}=n;setTimeout(()=>{Rt(n)?this.events.emit(Fe("session_ping",i),{}):mt(n)&&this.events.emit(Fe("session_ping",i),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:i}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),this.client.core.relayer.once(Ve.publish,async()=>{await this.deleteSession(r)}),await this.sendResult(i,r,!0),this.client.events.emit("session_delete",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidRequest(bt({topic:r},s)),await this.setPendingSessionRequest({id:i,topic:r,params:s}),this.client.events.emit("session_request",{id:i,topic:r,params:s})}catch(a){await this.sendError(i,r,a),this.client.logger.error(a)}},this.onSessionRequestResponse=(r,n)=>{const{id:i}=n;Rt(n)?this.events.emit(Fe("session_request",i),{result:n.result}):mt(n)&&this.events.emit(Fe("session_request",i),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidEmit(bt({topic:r},s)),this.client.events.emit("session_event",{id:i,topic:r,params:s})}catch(a){await this.sendError(i,r,a),this.client.logger.error(a)}},this.isValidConnect=async r=>{if(!dt(r)){const{message:h}=H("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(h)}const{pairingTopic:n,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:a,relays:c}=r;if(at(n)||await this.isValidPairingTopic(n),!Sp(c,!0)){const{message:h}=H("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(h)}!at(i)&&Rr(i)!==0&&this.validateNamespaces(i,"requiredNamespaces"),!at(s)&&Rr(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),at(a)||this.validateSessionProps(a,"sessionProperties")},this.validateNamespaces=(r,n)=>{const i=Ep(r,"connect()",n);if(i)throw new Error(i.message)},this.isValidApprove=async r=>{if(!dt(r))throw new Error(H("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:i,relayProtocol:s,sessionProperties:a}=r;await this.isValidProposalId(n);const c=this.client.proposal.get(n),h=un(i,"approve()");if(h)throw new Error(h.message);const f=vi(c.requiredNamespaces,i,"approve()","requiredNamespaces");if(f)throw new Error(f.message);if(!He(s,!0)){const{message:l}=H("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(l)}if(Object.keys(i).length>Object.keys(c.requiredNamespaces).length){const l=Object.keys(c.optionalNamespaces).filter(y=>i[y]),m={};for(const y in c.optionalNamespaces)l.includes(y)&&(m[y]=c.optionalNamespaces[y]);const b=vi(m,i,"approve()","optionalNamespaces");if(b)throw new Error(b.message)}at(a)||this.validateSessionProps(a,"sessionProperties")},this.isValidReject=async r=>{if(!dt(r)){const{message:s}=H("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:n,reason:i}=r;if(await this.isValidProposalId(n),!Op(i)){const{message:s}=H("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!dt(r)){const{message:f}=H("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(f)}const{relay:n,controller:i,namespaces:s,expiry:a}=r;if(!Vo(n)){const{message:f}=H("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(f)}const c=_p(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);const h=un(s,"onSessionSettleRequest()");if(h)throw new Error(h.message);if($t(a)){const{message:f}=H("EXPIRED","onSessionSettleRequest()");throw new Error(f)}},this.isValidUpdate=async r=>{if(!dt(r)){const{message:h}=H("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(h)}const{topic:n,namespaces:i}=r;await this.isValidSessionTopic(n);const s=this.client.session.get(n),a=un(i,"update()");if(a)throw new Error(a.message);const c=vi(s.requiredNamespaces,i,"update()","requiredNamespaces");if(c)throw new Error(c.message)},this.isValidExtend=async r=>{if(!dt(r)){const{message:i}=H("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!dt(r)){const{message:h}=H("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(h)}const{topic:n,request:i,chainId:s,expiry:a}=r;await this.isValidSessionTopic(n);const{namespaces:c}=this.client.session.get(n);if(!Go(c,s)){const{message:h}=H("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(h)}if(!xp(i)){const{message:h}=H("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(h)}if(!Np(c,s,i.method)){const{message:h}=H("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(h)}if(a&&!Pp(a,_n)){const{message:h}=H("MISSING_OR_INVALID",`request() expiry: ${a}. Expiry must be a number (in seconds) between ${_n.min} and ${_n.max}`);throw new Error(h)}},this.isValidRespond=async r=>{if(!dt(r)){const{message:s}=H("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:n,response:i}=r;if(await this.isValidSessionTopic(n),!Ip(i)){const{message:s}=H("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!dt(r)){const{message:i}=H("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!dt(r)){const{message:c}=H("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(c)}const{topic:n,event:i,chainId:s}=r;await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!Go(a,s)){const{message:c}=H("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(c)}if(!Tp(i)){const{message:c}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(c)}if(!Ap(a,s,i.name)){const{message:c}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(c)}},this.isValidDisconnect=async r=>{if(!dt(r)){const{message:i}=H("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(i=>{if(!He(i,!1)){const{message:s}=H("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(i)}`);throw new Error(s)}})}}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Ve.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const i=await this.client.core.crypto.decode(r,n);Ii(i)?(this.client.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):Ti(i)&&(await this.client.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.client.core.expirer.on(yt.expired,async e=>{const{topic:r,id:n}=zo(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,H("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(e){if(!He(e,!1)){const{message:r}=H("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if($t(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=H("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!He(e,!1)){const{message:r}=H("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if($t(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=H("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(He(e,!1)){const{message:r}=H("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=H("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Dp(e)){const{message:r}=H("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if($t(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=H("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class iy extends dn{constructor(e,r){super(e,r,Ua,pn),this.core=e,this.logger=r}}class sy extends dn{constructor(e,r){super(e,r,Ma,pn),this.core=e,this.logger=r}}class oy extends dn{constructor(e,r){super(e,r,za,pn),this.core=e,this.logger=r}}class yn extends Sf{constructor(e){super(e),this.protocol=Ui,this.version=$i,this.name=gn.name,this.events=new ut.exports.EventEmitter,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(i){throw this.logger.error(i.message),i}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(i){throw this.logger.error(i.message),i}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(i){throw this.logger.error(i.message),i}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(i){throw this.logger.error(i.message),i}},this.update=async n=>{try{return await this.engine.update(n)}catch(i){throw this.logger.error(i.message),i}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(i){throw this.logger.error(i.message),i}},this.request=async n=>{try{return await this.engine.request(n)}catch(i){throw this.logger.error(i.message),i}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(i){throw this.logger.error(i.message),i}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(i){throw this.logger.error(i.message),i}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(i){throw this.logger.error(i.message),i}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(i){throw this.logger.error(i.message),i}},this.find=n=>{try{return this.engine.find(n)}catch(i){throw this.logger.error(i.message),i}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=e?.name||gn.name,this.metadata=e?.metadata||Kd();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:qr(Oe.getDefaultLoggerOptions({level:e?.logger||gn.logger}));this.core=e?.core||new V_(e),this.logger=Oe.generateChildLogger(r,this.name),this.session=new sy(this.core,this.logger),this.proposal=new iy(this.core,this.logger),this.pendingRequest=new oy(this.core,this.logger),this.engine=new ny(this)}static async init(e){const r=new yn(e);return await r.initialize(),r}get context(){return Oe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const ay=yn;xe.ENGINE_CONTEXT=ja,xe.ENGINE_RPC_OPTS=ur,xe.HISTORY_CONTEXT=k_,xe.HISTORY_EVENTS=Y_,xe.HISTORY_STORAGE_VERSION=X_,xe.PROPOSAL_CONTEXT=Ua,xe.PROPOSAL_EXPIRY=J_,xe.PROPOSAL_EXPIRY_MESSAGE=$a,xe.REQUEST_CONTEXT=za,xe.SESSION_CONTEXT=Ma,xe.SESSION_EXPIRY=Mr,xe.SESSION_REQUEST_EXPIRY_BOUNDARIES=_n,xe.SIGN_CLIENT_CONTEXT=Mi,xe.SIGN_CLIENT_DEFAULT=gn,xe.SIGN_CLIENT_EVENTS=G_,xe.SIGN_CLIENT_PROTOCOL=Ui,xe.SIGN_CLIENT_STORAGE_OPTIONS=W_,xe.SIGN_CLIENT_STORAGE_PREFIX=pn,xe.SIGN_CLIENT_VERSION=$i,xe.SignClient=ay,xe.default=yn,Object.defineProperty(xe,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
